#include "p35pf.h"

#include <Eigen/Dense>

namespace poselib {

void fast_eigenvector_solver(double *eigv, int neig, const Eigen::Matrix<double, 10, 10> &AM,
                             Eigen::Matrix<double, 4, 10> *sols) {
    static const int ind[] = {2, 4, 6, 7, 9};
    // Truncated action matrix containing non-trivial rows
    Eigen::Matrix<double, 5, 10> AMs;
    double zi[3];

    for (int i = 0; i < 5; i++) {
        AMs.row(i) = AM.row(ind[i]);
    }
    for (int i = 0; i < neig; i++) {
        zi[0] = eigv[i];
        for (int j = 1; j < 3; j++) {
            zi[j] = zi[j - 1] * eigv[i];
        }
        Eigen::Matrix<double, 5, 5> AA;
        AA.col(0) = AMs.col(1) + zi[0] * AMs.col(2);
        AA.col(1) = AMs.col(3) + zi[0] * AMs.col(4);
        AA.col(2) = AMs.col(6);
        AA.col(3) = AMs.col(5) + zi[0] * AMs.col(7);
        AA.col(4) = AMs.col(0) + zi[0] * AMs.col(8) + zi[1] * AMs.col(9);
        AA(0, 0) = AA(0, 0) - zi[1];
        AA(1, 1) = AA(1, 1) - zi[1];
        AA(2, 2) = AA(2, 2) - zi[0];
        AA(3, 3) = AA(3, 3) - zi[1];
        AA(4, 4) = AA(4, 4) - zi[2];

        Eigen::Matrix<double, 4, 1> s = AA.leftCols(4).colPivHouseholderQr().solve(-AA.col(4));
        (*sols)(0, i) = s(0);
        (*sols)(1, i) = s(1);
        (*sols)(2, i) = s(3);
        (*sols)(3, i) = zi[0];
    }
}

int p35pf(const std::vector<Eigen::Vector2d> &points2d, const std::vector<Eigen::Vector3d> &points3d,
          std::vector<CameraPose> *output_poses, std::vector<double> *output_focals, bool normalize_input) {

    if (normalize_input) {
        // TODO: Normalization of world coordinate systems

        double focal0 = 0.0;
        for (int i = 0; i < 4; ++i) {
            focal0 += points2d[i].norm();
        }
        focal0 /= 4;

        std::vector<Eigen::Vector2d> scaled_points2d;
        for (int i = 0; i < 4; ++i) {
            scaled_points2d.push_back(points2d[i] / focal0);
        }

        int n_sols = p35pf(scaled_points2d, points3d, output_poses, output_focals, false);

        for (int i = 0; i < n_sols; ++i) {
            (*output_focals)[i] *= focal0;
        }
        return n_sols;
    }

    // Setup nullspace
    Eigen::Matrix<double, 12, 7> M;
    Eigen::Matrix<double, 12, 5> N;

    for (int i = 0; i < 3; i++) {
        M.col(2 * i) << -points3d[i](0), 0.0, points3d[i](0) * points2d[i](0), -points3d[i](1), 0.0,
            points3d[i](1) * points2d[i](0), -points3d[i](2), 0.0, points3d[i](2) * points2d[i](0), -1, 0.0,
            points2d[i](0);
        M.col(2 * i + 1) << 0.0, -points3d[i](0), points3d[i](0) * points2d[i](1), 0.0, -points3d[i](1),
            points3d[i](1) * points2d[i](1), 0.0, -points3d[i](2), points3d[i](2) * points2d[i](1), 0.0, -1,
            points2d[i](1);
    }
    M.col(6) << -points3d[3](0), 0.0, points3d[3](0) * points2d[3](0), -points3d[3](1), 0.0,
        points3d[3](1) * points2d[3](0), -points3d[3](2), 0.0, points3d[3](2) * points2d[3](0), -1, 0.0, points2d[3](0);

    // Compute nullspace using QR
    Eigen::Matrix<double, 12, 12> Q = M.householderQr().householderQ();
    N = Q.rightCols(5);

    // Compute coefficients
    const double *d = N.data();
    double coeffs[235];
    coeffs[0] = d[1] * d[2] + d[4] * d[5] + d[7] * d[8];
    coeffs[1] = d[2] * d[13] + d[1] * d[14] + d[5] * d[16] + d[4] * d[17] + d[8] * d[19] + d[7] * d[20];
    coeffs[2] = d[13] * d[14] + d[16] * d[17] + d[19] * d[20];
    coeffs[3] = d[2] * d[25] + d[1] * d[26] + d[5] * d[28] + d[4] * d[29] + d[8] * d[31] + d[7] * d[32];
    coeffs[4] = d[14] * d[25] + d[13] * d[26] + d[17] * d[28] + d[16] * d[29] + d[20] * d[31] + d[19] * d[32];
    coeffs[5] = d[25] * d[26] + d[28] * d[29] + d[31] * d[32];
    coeffs[6] = d[2] * d[37] + d[1] * d[38] + d[5] * d[40] + d[4] * d[41] + d[8] * d[43] + d[7] * d[44];
    coeffs[7] = d[14] * d[37] + d[13] * d[38] + d[17] * d[40] + d[16] * d[41] + d[20] * d[43] + d[19] * d[44];
    coeffs[8] = d[26] * d[37] + d[25] * d[38] + d[29] * d[40] + d[28] * d[41] + d[32] * d[43] + d[31] * d[44];
    coeffs[9] = d[37] * d[38] + d[40] * d[41] + d[43] * d[44];
    coeffs[10] = d[2] * d[49] + d[1] * d[50] + d[5] * d[52] + d[4] * d[53] + d[8] * d[55] + d[7] * d[56];
    coeffs[11] = d[14] * d[49] + d[13] * d[50] + d[17] * d[52] + d[16] * d[53] + d[20] * d[55] + d[19] * d[56];
    coeffs[12] = d[26] * d[49] + d[25] * d[50] + d[29] * d[52] + d[28] * d[53] + d[32] * d[55] + d[31] * d[56];
    coeffs[13] = d[38] * d[49] + d[37] * d[50] + d[41] * d[52] + d[40] * d[53] + d[44] * d[55] + d[43] * d[56];
    coeffs[14] = d[49] * d[50] + d[52] * d[53] + d[55] * d[56];
    coeffs[15] = d[0] * d[2] + d[3] * d[5] + d[6] * d[8];
    coeffs[16] = d[2] * d[12] + d[0] * d[14] + d[5] * d[15] + d[3] * d[17] + d[8] * d[18] + d[6] * d[20];
    coeffs[17] = d[12] * d[14] + d[15] * d[17] + d[18] * d[20];
    coeffs[18] = d[2] * d[24] + d[0] * d[26] + d[5] * d[27] + d[3] * d[29] + d[8] * d[30] + d[6] * d[32];
    coeffs[19] = d[14] * d[24] + d[12] * d[26] + d[17] * d[27] + d[15] * d[29] + d[20] * d[30] + d[18] * d[32];
    coeffs[20] = d[24] * d[26] + d[27] * d[29] + d[30] * d[32];
    coeffs[21] = d[2] * d[36] + d[0] * d[38] + d[5] * d[39] + d[3] * d[41] + d[8] * d[42] + d[6] * d[44];
    coeffs[22] = d[14] * d[36] + d[12] * d[38] + d[17] * d[39] + d[15] * d[41] + d[20] * d[42] + d[18] * d[44];
    coeffs[23] = d[26] * d[36] + d[24] * d[38] + d[29] * d[39] + d[27] * d[41] + d[32] * d[42] + d[30] * d[44];
    coeffs[24] = d[36] * d[38] + d[39] * d[41] + d[42] * d[44];
    coeffs[25] = d[2] * d[48] + d[0] * d[50] + d[5] * d[51] + d[3] * d[53] + d[8] * d[54] + d[6] * d[56];
    coeffs[26] = d[14] * d[48] + d[12] * d[50] + d[17] * d[51] + d[15] * d[53] + d[20] * d[54] + d[18] * d[56];
    coeffs[27] = d[26] * d[48] + d[24] * d[50] + d[29] * d[51] + d[27] * d[53] + d[32] * d[54] + d[30] * d[56];
    coeffs[28] = d[38] * d[48] + d[36] * d[50] + d[41] * d[51] + d[39] * d[53] + d[44] * d[54] + d[42] * d[56];
    coeffs[29] = d[48] * d[50] + d[51] * d[53] + d[54] * d[56];
    coeffs[30] = d[0] * d[1] + d[3] * d[4] + d[6] * d[7];
    coeffs[31] = d[1] * d[12] + d[0] * d[13] + d[4] * d[15] + d[3] * d[16] + d[7] * d[18] + d[6] * d[19];
    coeffs[32] = d[12] * d[13] + d[15] * d[16] + d[18] * d[19];
    coeffs[33] = d[1] * d[24] + d[0] * d[25] + d[4] * d[27] + d[3] * d[28] + d[7] * d[30] + d[6] * d[31];
    coeffs[34] = d[13] * d[24] + d[12] * d[25] + d[16] * d[27] + d[15] * d[28] + d[19] * d[30] + d[18] * d[31];
    coeffs[35] = d[24] * d[25] + d[27] * d[28] + d[30] * d[31];
    coeffs[36] = d[1] * d[36] + d[0] * d[37] + d[4] * d[39] + d[3] * d[40] + d[7] * d[42] + d[6] * d[43];
    coeffs[37] = d[13] * d[36] + d[12] * d[37] + d[16] * d[39] + d[15] * d[40] + d[19] * d[42] + d[18] * d[43];
    coeffs[38] = d[25] * d[36] + d[24] * d[37] + d[28] * d[39] + d[27] * d[40] + d[31] * d[42] + d[30] * d[43];
    coeffs[39] = d[36] * d[37] + d[39] * d[40] + d[42] * d[43];
    coeffs[40] = d[1] * d[48] + d[0] * d[49] + d[4] * d[51] + d[3] * d[52] + d[7] * d[54] + d[6] * d[55];
    coeffs[41] = d[13] * d[48] + d[12] * d[49] + d[16] * d[51] + d[15] * d[52] + d[19] * d[54] + d[18] * d[55];
    coeffs[42] = d[25] * d[48] + d[24] * d[49] + d[28] * d[51] + d[27] * d[52] + d[31] * d[54] + d[30] * d[55];
    coeffs[43] = d[37] * d[48] + d[36] * d[49] + d[40] * d[51] + d[39] * d[52] + d[43] * d[54] + d[42] * d[55];
    coeffs[44] = d[48] * d[49] + d[51] * d[52] + d[54] * d[55];
    coeffs[45] = d[0] * d[0] - d[1] * d[1] + d[3] * d[3] - d[4] * d[4] + d[6] * d[6] - d[7] * d[7];
    coeffs[46] =
        2 * d[0] * d[12] - 2 * d[1] * d[13] + 2 * d[3] * d[15] - 2 * d[4] * d[16] + 2 * d[6] * d[18] - 2 * d[7] * d[19];
    coeffs[47] = d[12] * d[12] - d[13] * d[13] + d[15] * d[15] - d[16] * d[16] + d[18] * d[18] - d[19] * d[19];
    coeffs[48] =
        2 * d[0] * d[24] - 2 * d[1] * d[25] + 2 * d[3] * d[27] - 2 * d[4] * d[28] + 2 * d[6] * d[30] - 2 * d[7] * d[31];
    coeffs[49] = 2 * d[12] * d[24] - 2 * d[13] * d[25] + 2 * d[15] * d[27] - 2 * d[16] * d[28] + 2 * d[18] * d[30] -
                 2 * d[19] * d[31];
    coeffs[50] = d[24] * d[24] - d[25] * d[25] + d[27] * d[27] - d[28] * d[28] + d[30] * d[30] - d[31] * d[31];
    coeffs[51] =
        2 * d[0] * d[36] - 2 * d[1] * d[37] + 2 * d[3] * d[39] - 2 * d[4] * d[40] + 2 * d[6] * d[42] - 2 * d[7] * d[43];
    coeffs[52] = 2 * d[12] * d[36] - 2 * d[13] * d[37] + 2 * d[15] * d[39] - 2 * d[16] * d[40] + 2 * d[18] * d[42] -
                 2 * d[19] * d[43];
    coeffs[53] = 2 * d[24] * d[36] - 2 * d[25] * d[37] + 2 * d[27] * d[39] - 2 * d[28] * d[40] + 2 * d[30] * d[42] -
                 2 * d[31] * d[43];
    coeffs[54] = d[36] * d[36] - d[37] * d[37] + d[39] * d[39] - d[40] * d[40] + d[42] * d[42] - d[43] * d[43];
    coeffs[55] =
        2 * d[0] * d[48] - 2 * d[1] * d[49] + 2 * d[3] * d[51] - 2 * d[4] * d[52] + 2 * d[6] * d[54] - 2 * d[7] * d[55];
    coeffs[56] = 2 * d[12] * d[48] - 2 * d[13] * d[49] + 2 * d[15] * d[51] - 2 * d[16] * d[52] + 2 * d[18] * d[54] -
                 2 * d[19] * d[55];
    coeffs[57] = 2 * d[24] * d[48] - 2 * d[25] * d[49] + 2 * d[27] * d[51] - 2 * d[28] * d[52] + 2 * d[30] * d[54] -
                 2 * d[31] * d[55];
    coeffs[58] = 2 * d[36] * d[48] - 2 * d[37] * d[49] + 2 * d[39] * d[51] - 2 * d[40] * d[52] + 2 * d[42] * d[54] -
                 2 * d[43] * d[55];
    coeffs[59] = d[48] * d[48] - d[49] * d[49] + d[51] * d[51] - d[52] * d[52] + d[54] * d[54] - d[55] * d[55];
    coeffs[60] =
        -d[1] * d[1] * d[5] - d[4] * d[4] * d[5] + d[5] * d[6] * d[6] - d[3] * d[6] * d[8] - d[4] * d[7] * d[8];
    coeffs[61] = -2 * d[1] * d[5] * d[13] - d[6] * d[8] * d[15] - 2 * d[4] * d[5] * d[16] - d[7] * d[8] * d[16] -
                 d[1] * d[1] * d[17] - d[4] * d[4] * d[17] + d[6] * d[6] * d[17] + 2 * d[5] * d[6] * d[18] -
                 d[3] * d[8] * d[18] - d[4] * d[8] * d[19] - d[3] * d[6] * d[20] - d[4] * d[7] * d[20];
    coeffs[62] = -d[5] * d[13] * d[13] - d[5] * d[16] * d[16] - 2 * d[1] * d[13] * d[17] - 2 * d[4] * d[16] * d[17] -
                 d[8] * d[15] * d[18] + 2 * d[6] * d[17] * d[18] + d[5] * d[18] * d[18] - d[8] * d[16] * d[19] -
                 d[6] * d[15] * d[20] - d[7] * d[16] * d[20] - d[3] * d[18] * d[20] - d[4] * d[19] * d[20];
    coeffs[63] = -d[13] * d[13] * d[17] - d[16] * d[16] * d[17] + d[17] * d[18] * d[18] - d[15] * d[18] * d[20] -
                 d[16] * d[19] * d[20];
    coeffs[64] = -2 * d[1] * d[5] * d[25] - d[6] * d[8] * d[27] - 2 * d[4] * d[5] * d[28] - d[7] * d[8] * d[28] -
                 d[1] * d[1] * d[29] - d[4] * d[4] * d[29] + d[6] * d[6] * d[29] + 2 * d[5] * d[6] * d[30] -
                 d[3] * d[8] * d[30] - d[4] * d[8] * d[31] - d[3] * d[6] * d[32] - d[4] * d[7] * d[32];
    coeffs[65] = -2 * d[5] * d[13] * d[25] - 2 * d[1] * d[17] * d[25] - d[8] * d[18] * d[27] - d[6] * d[20] * d[27] -
                 2 * d[5] * d[16] * d[28] - 2 * d[4] * d[17] * d[28] - d[8] * d[19] * d[28] - d[7] * d[20] * d[28] -
                 2 * d[1] * d[13] * d[29] - 2 * d[4] * d[16] * d[29] + 2 * d[6] * d[18] * d[29] - d[8] * d[15] * d[30] +
                 2 * d[6] * d[17] * d[30] + 2 * d[5] * d[18] * d[30] - d[3] * d[20] * d[30] - d[8] * d[16] * d[31] -
                 d[4] * d[20] * d[31] - d[6] * d[15] * d[32] - d[7] * d[16] * d[32] - d[3] * d[18] * d[32] -
                 d[4] * d[19] * d[32];
    coeffs[66] = -2 * d[13] * d[17] * d[25] - d[18] * d[20] * d[27] - 2 * d[16] * d[17] * d[28] -
                 d[19] * d[20] * d[28] - d[13] * d[13] * d[29] - d[16] * d[16] * d[29] + d[18] * d[18] * d[29] +
                 2 * d[17] * d[18] * d[30] - d[15] * d[20] * d[30] - d[16] * d[20] * d[31] - d[15] * d[18] * d[32] -
                 d[16] * d[19] * d[32];
    coeffs[67] = -d[5] * d[25] * d[25] - d[5] * d[28] * d[28] - 2 * d[1] * d[25] * d[29] - 2 * d[4] * d[28] * d[29] -
                 d[8] * d[27] * d[30] + 2 * d[6] * d[29] * d[30] + d[5] * d[30] * d[30] - d[8] * d[28] * d[31] -
                 d[6] * d[27] * d[32] - d[7] * d[28] * d[32] - d[3] * d[30] * d[32] - d[4] * d[31] * d[32];
    coeffs[68] = -d[17] * d[25] * d[25] - d[17] * d[28] * d[28] - 2 * d[13] * d[25] * d[29] -
                 2 * d[16] * d[28] * d[29] - d[20] * d[27] * d[30] + 2 * d[18] * d[29] * d[30] + d[17] * d[30] * d[30] -
                 d[20] * d[28] * d[31] - d[18] * d[27] * d[32] - d[19] * d[28] * d[32] - d[15] * d[30] * d[32] -
                 d[16] * d[31] * d[32];
    coeffs[69] = -d[25] * d[25] * d[29] - d[28] * d[28] * d[29] + d[29] * d[30] * d[30] - d[27] * d[30] * d[32] -
                 d[28] * d[31] * d[32];
    coeffs[70] = -2 * d[1] * d[5] * d[37] - d[6] * d[8] * d[39] - 2 * d[4] * d[5] * d[40] - d[7] * d[8] * d[40] -
                 d[1] * d[1] * d[41] - d[4] * d[4] * d[41] + d[6] * d[6] * d[41] + 2 * d[5] * d[6] * d[42] -
                 d[3] * d[8] * d[42] - d[4] * d[8] * d[43] - d[3] * d[6] * d[44] - d[4] * d[7] * d[44];
    coeffs[71] = -2 * d[5] * d[13] * d[37] - 2 * d[1] * d[17] * d[37] - d[8] * d[18] * d[39] - d[6] * d[20] * d[39] -
                 2 * d[5] * d[16] * d[40] - 2 * d[4] * d[17] * d[40] - d[8] * d[19] * d[40] - d[7] * d[20] * d[40] -
                 2 * d[1] * d[13] * d[41] - 2 * d[4] * d[16] * d[41] + 2 * d[6] * d[18] * d[41] - d[8] * d[15] * d[42] +
                 2 * d[6] * d[17] * d[42] + 2 * d[5] * d[18] * d[42] - d[3] * d[20] * d[42] - d[8] * d[16] * d[43] -
                 d[4] * d[20] * d[43] - d[6] * d[15] * d[44] - d[7] * d[16] * d[44] - d[3] * d[18] * d[44] -
                 d[4] * d[19] * d[44];
    coeffs[72] = -2 * d[13] * d[17] * d[37] - d[18] * d[20] * d[39] - 2 * d[16] * d[17] * d[40] -
                 d[19] * d[20] * d[40] - d[13] * d[13] * d[41] - d[16] * d[16] * d[41] + d[18] * d[18] * d[41] +
                 2 * d[17] * d[18] * d[42] - d[15] * d[20] * d[42] - d[16] * d[20] * d[43] - d[15] * d[18] * d[44] -
                 d[16] * d[19] * d[44];
    coeffs[73] = -2 * d[5] * d[25] * d[37] - 2 * d[1] * d[29] * d[37] - d[8] * d[30] * d[39] - d[6] * d[32] * d[39] -
                 2 * d[5] * d[28] * d[40] - 2 * d[4] * d[29] * d[40] - d[8] * d[31] * d[40] - d[7] * d[32] * d[40] -
                 2 * d[1] * d[25] * d[41] - 2 * d[4] * d[28] * d[41] + 2 * d[6] * d[30] * d[41] - d[8] * d[27] * d[42] +
                 2 * d[6] * d[29] * d[42] + 2 * d[5] * d[30] * d[42] - d[3] * d[32] * d[42] - d[8] * d[28] * d[43] -
                 d[4] * d[32] * d[43] - d[6] * d[27] * d[44] - d[7] * d[28] * d[44] - d[3] * d[30] * d[44] -
                 d[4] * d[31] * d[44];
    coeffs[74] = -2 * d[17] * d[25] * d[37] - 2 * d[13] * d[29] * d[37] - d[20] * d[30] * d[39] -
                 d[18] * d[32] * d[39] - 2 * d[17] * d[28] * d[40] - 2 * d[16] * d[29] * d[40] - d[20] * d[31] * d[40] -
                 d[19] * d[32] * d[40] - 2 * d[13] * d[25] * d[41] - 2 * d[16] * d[28] * d[41] +
                 2 * d[18] * d[30] * d[41] - d[20] * d[27] * d[42] + 2 * d[18] * d[29] * d[42] +
                 2 * d[17] * d[30] * d[42] - d[15] * d[32] * d[42] - d[20] * d[28] * d[43] - d[16] * d[32] * d[43] -
                 d[18] * d[27] * d[44] - d[19] * d[28] * d[44] - d[15] * d[30] * d[44] - d[16] * d[31] * d[44];
    coeffs[75] = -2 * d[25] * d[29] * d[37] - d[30] * d[32] * d[39] - 2 * d[28] * d[29] * d[40] -
                 d[31] * d[32] * d[40] - d[25] * d[25] * d[41] - d[28] * d[28] * d[41] + d[30] * d[30] * d[41] +
                 2 * d[29] * d[30] * d[42] - d[27] * d[32] * d[42] - d[28] * d[32] * d[43] - d[27] * d[30] * d[44] -
                 d[28] * d[31] * d[44];
    coeffs[76] = -d[5] * d[37] * d[37] - d[5] * d[40] * d[40] - 2 * d[1] * d[37] * d[41] - 2 * d[4] * d[40] * d[41] -
                 d[8] * d[39] * d[42] + 2 * d[6] * d[41] * d[42] + d[5] * d[42] * d[42] - d[8] * d[40] * d[43] -
                 d[6] * d[39] * d[44] - d[7] * d[40] * d[44] - d[3] * d[42] * d[44] - d[4] * d[43] * d[44];
    coeffs[77] = -d[17] * d[37] * d[37] - d[17] * d[40] * d[40] - 2 * d[13] * d[37] * d[41] -
                 2 * d[16] * d[40] * d[41] - d[20] * d[39] * d[42] + 2 * d[18] * d[41] * d[42] + d[17] * d[42] * d[42] -
                 d[20] * d[40] * d[43] - d[18] * d[39] * d[44] - d[19] * d[40] * d[44] - d[15] * d[42] * d[44] -
                 d[16] * d[43] * d[44];
    coeffs[78] = -d[29] * d[37] * d[37] - d[29] * d[40] * d[40] - 2 * d[25] * d[37] * d[41] -
                 2 * d[28] * d[40] * d[41] - d[32] * d[39] * d[42] + 2 * d[30] * d[41] * d[42] + d[29] * d[42] * d[42] -
                 d[32] * d[40] * d[43] - d[30] * d[39] * d[44] - d[31] * d[40] * d[44] - d[27] * d[42] * d[44] -
                 d[28] * d[43] * d[44];
    coeffs[79] = -d[37] * d[37] * d[41] - d[40] * d[40] * d[41] + d[41] * d[42] * d[42] - d[39] * d[42] * d[44] -
                 d[40] * d[43] * d[44];
    coeffs[80] = -2 * d[1] * d[5] * d[49] - d[6] * d[8] * d[51] - 2 * d[4] * d[5] * d[52] - d[7] * d[8] * d[52] -
                 d[1] * d[1] * d[53] - d[4] * d[4] * d[53] + d[6] * d[6] * d[53] + 2 * d[5] * d[6] * d[54] -
                 d[3] * d[8] * d[54] - d[4] * d[8] * d[55] - d[3] * d[6] * d[56] - d[4] * d[7] * d[56];
    coeffs[81] = -2 * d[5] * d[13] * d[49] - 2 * d[1] * d[17] * d[49] - d[8] * d[18] * d[51] - d[6] * d[20] * d[51] -
                 2 * d[5] * d[16] * d[52] - 2 * d[4] * d[17] * d[52] - d[8] * d[19] * d[52] - d[7] * d[20] * d[52] -
                 2 * d[1] * d[13] * d[53] - 2 * d[4] * d[16] * d[53] + 2 * d[6] * d[18] * d[53] - d[8] * d[15] * d[54] +
                 2 * d[6] * d[17] * d[54] + 2 * d[5] * d[18] * d[54] - d[3] * d[20] * d[54] - d[8] * d[16] * d[55] -
                 d[4] * d[20] * d[55] - d[6] * d[15] * d[56] - d[7] * d[16] * d[56] - d[3] * d[18] * d[56] -
                 d[4] * d[19] * d[56];
    coeffs[82] = -2 * d[13] * d[17] * d[49] - d[18] * d[20] * d[51] - 2 * d[16] * d[17] * d[52] -
                 d[19] * d[20] * d[52] - d[13] * d[13] * d[53] - d[16] * d[16] * d[53] + d[18] * d[18] * d[53] +
                 2 * d[17] * d[18] * d[54] - d[15] * d[20] * d[54] - d[16] * d[20] * d[55] - d[15] * d[18] * d[56] -
                 d[16] * d[19] * d[56];
    coeffs[83] = -2 * d[5] * d[25] * d[49] - 2 * d[1] * d[29] * d[49] - d[8] * d[30] * d[51] - d[6] * d[32] * d[51] -
                 2 * d[5] * d[28] * d[52] - 2 * d[4] * d[29] * d[52] - d[8] * d[31] * d[52] - d[7] * d[32] * d[52] -
                 2 * d[1] * d[25] * d[53] - 2 * d[4] * d[28] * d[53] + 2 * d[6] * d[30] * d[53] - d[8] * d[27] * d[54] +
                 2 * d[6] * d[29] * d[54] + 2 * d[5] * d[30] * d[54] - d[3] * d[32] * d[54] - d[8] * d[28] * d[55] -
                 d[4] * d[32] * d[55] - d[6] * d[27] * d[56] - d[7] * d[28] * d[56] - d[3] * d[30] * d[56] -
                 d[4] * d[31] * d[56];
    coeffs[84] = -2 * d[17] * d[25] * d[49] - 2 * d[13] * d[29] * d[49] - d[20] * d[30] * d[51] -
                 d[18] * d[32] * d[51] - 2 * d[17] * d[28] * d[52] - 2 * d[16] * d[29] * d[52] - d[20] * d[31] * d[52] -
                 d[19] * d[32] * d[52] - 2 * d[13] * d[25] * d[53] - 2 * d[16] * d[28] * d[53] +
                 2 * d[18] * d[30] * d[53] - d[20] * d[27] * d[54] + 2 * d[18] * d[29] * d[54] +
                 2 * d[17] * d[30] * d[54] - d[15] * d[32] * d[54] - d[20] * d[28] * d[55] - d[16] * d[32] * d[55] -
                 d[18] * d[27] * d[56] - d[19] * d[28] * d[56] - d[15] * d[30] * d[56] - d[16] * d[31] * d[56];
    coeffs[85] = -2 * d[25] * d[29] * d[49] - d[30] * d[32] * d[51] - 2 * d[28] * d[29] * d[52] -
                 d[31] * d[32] * d[52] - d[25] * d[25] * d[53] - d[28] * d[28] * d[53] + d[30] * d[30] * d[53] +
                 2 * d[29] * d[30] * d[54] - d[27] * d[32] * d[54] - d[28] * d[32] * d[55] - d[27] * d[30] * d[56] -
                 d[28] * d[31] * d[56];
    coeffs[86] = -2 * d[5] * d[37] * d[49] - 2 * d[1] * d[41] * d[49] - d[8] * d[42] * d[51] - d[6] * d[44] * d[51] -
                 2 * d[5] * d[40] * d[52] - 2 * d[4] * d[41] * d[52] - d[8] * d[43] * d[52] - d[7] * d[44] * d[52] -
                 2 * d[1] * d[37] * d[53] - 2 * d[4] * d[40] * d[53] + 2 * d[6] * d[42] * d[53] - d[8] * d[39] * d[54] +
                 2 * d[6] * d[41] * d[54] + 2 * d[5] * d[42] * d[54] - d[3] * d[44] * d[54] - d[8] * d[40] * d[55] -
                 d[4] * d[44] * d[55] - d[6] * d[39] * d[56] - d[7] * d[40] * d[56] - d[3] * d[42] * d[56] -
                 d[4] * d[43] * d[56];
    coeffs[87] = -2 * d[17] * d[37] * d[49] - 2 * d[13] * d[41] * d[49] - d[20] * d[42] * d[51] -
                 d[18] * d[44] * d[51] - 2 * d[17] * d[40] * d[52] - 2 * d[16] * d[41] * d[52] - d[20] * d[43] * d[52] -
                 d[19] * d[44] * d[52] - 2 * d[13] * d[37] * d[53] - 2 * d[16] * d[40] * d[53] +
                 2 * d[18] * d[42] * d[53] - d[20] * d[39] * d[54] + 2 * d[18] * d[41] * d[54] +
                 2 * d[17] * d[42] * d[54] - d[15] * d[44] * d[54] - d[20] * d[40] * d[55] - d[16] * d[44] * d[55] -
                 d[18] * d[39] * d[56] - d[19] * d[40] * d[56] - d[15] * d[42] * d[56] - d[16] * d[43] * d[56];
    coeffs[88] = -2 * d[29] * d[37] * d[49] - 2 * d[25] * d[41] * d[49] - d[32] * d[42] * d[51] -
                 d[30] * d[44] * d[51] - 2 * d[29] * d[40] * d[52] - 2 * d[28] * d[41] * d[52] - d[32] * d[43] * d[52] -
                 d[31] * d[44] * d[52] - 2 * d[25] * d[37] * d[53] - 2 * d[28] * d[40] * d[53] +
                 2 * d[30] * d[42] * d[53] - d[32] * d[39] * d[54] + 2 * d[30] * d[41] * d[54] +
                 2 * d[29] * d[42] * d[54] - d[27] * d[44] * d[54] - d[32] * d[40] * d[55] - d[28] * d[44] * d[55] -
                 d[30] * d[39] * d[56] - d[31] * d[40] * d[56] - d[27] * d[42] * d[56] - d[28] * d[43] * d[56];
    coeffs[89] = -2 * d[37] * d[41] * d[49] - d[42] * d[44] * d[51] - 2 * d[40] * d[41] * d[52] -
                 d[43] * d[44] * d[52] - d[37] * d[37] * d[53] - d[40] * d[40] * d[53] + d[42] * d[42] * d[53] +
                 2 * d[41] * d[42] * d[54] - d[39] * d[44] * d[54] - d[40] * d[44] * d[55] - d[39] * d[42] * d[56] -
                 d[40] * d[43] * d[56];
    coeffs[90] = -d[5] * d[49] * d[49] - d[5] * d[52] * d[52] - 2 * d[1] * d[49] * d[53] - 2 * d[4] * d[52] * d[53] -
                 d[8] * d[51] * d[54] + 2 * d[6] * d[53] * d[54] + d[5] * d[54] * d[54] - d[8] * d[52] * d[55] -
                 d[6] * d[51] * d[56] - d[7] * d[52] * d[56] - d[3] * d[54] * d[56] - d[4] * d[55] * d[56];
    coeffs[91] = -d[17] * d[49] * d[49] - d[17] * d[52] * d[52] - 2 * d[13] * d[49] * d[53] -
                 2 * d[16] * d[52] * d[53] - d[20] * d[51] * d[54] + 2 * d[18] * d[53] * d[54] + d[17] * d[54] * d[54] -
                 d[20] * d[52] * d[55] - d[18] * d[51] * d[56] - d[19] * d[52] * d[56] - d[15] * d[54] * d[56] -
                 d[16] * d[55] * d[56];
    coeffs[92] = -d[29] * d[49] * d[49] - d[29] * d[52] * d[52] - 2 * d[25] * d[49] * d[53] -
                 2 * d[28] * d[52] * d[53] - d[32] * d[51] * d[54] + 2 * d[30] * d[53] * d[54] + d[29] * d[54] * d[54] -
                 d[32] * d[52] * d[55] - d[30] * d[51] * d[56] - d[31] * d[52] * d[56] - d[27] * d[54] * d[56] -
                 d[28] * d[55] * d[56];
    coeffs[93] = -d[41] * d[49] * d[49] - d[41] * d[52] * d[52] - 2 * d[37] * d[49] * d[53] -
                 2 * d[40] * d[52] * d[53] - d[44] * d[51] * d[54] + 2 * d[42] * d[53] * d[54] + d[41] * d[54] * d[54] -
                 d[44] * d[52] * d[55] - d[42] * d[51] * d[56] - d[43] * d[52] * d[56] - d[39] * d[54] * d[56] -
                 d[40] * d[55] * d[56];
    coeffs[94] = -d[49] * d[49] * d[53] - d[52] * d[52] * d[53] + d[53] * d[54] * d[54] - d[51] * d[54] * d[56] -
                 d[52] * d[55] * d[56];
    coeffs[95] = d[3] * d[5] * d[6] + d[4] * d[5] * d[7] + d[1] * d[1] * d[8] - d[3] * d[3] * d[8] + d[7] * d[7] * d[8];
    coeffs[96] = 2 * d[1] * d[8] * d[13] + d[5] * d[6] * d[15] - 2 * d[3] * d[8] * d[15] + d[5] * d[7] * d[16] +
                 d[3] * d[6] * d[17] + d[4] * d[7] * d[17] + d[3] * d[5] * d[18] + d[4] * d[5] * d[19] +
                 2 * d[7] * d[8] * d[19] + d[1] * d[1] * d[20] - d[3] * d[3] * d[20] + d[7] * d[7] * d[20];
    coeffs[97] = d[8] * d[13] * d[13] - d[8] * d[15] * d[15] + d[6] * d[15] * d[17] + d[7] * d[16] * d[17] +
                 d[5] * d[15] * d[18] + d[3] * d[17] * d[18] + d[5] * d[16] * d[19] + d[4] * d[17] * d[19] +
                 d[8] * d[19] * d[19] + 2 * d[1] * d[13] * d[20] - 2 * d[3] * d[15] * d[20] + 2 * d[7] * d[19] * d[20];
    coeffs[98] = d[15] * d[17] * d[18] + d[16] * d[17] * d[19] + d[13] * d[13] * d[20] - d[15] * d[15] * d[20] +
                 d[19] * d[19] * d[20];
    coeffs[99] = 2 * d[1] * d[8] * d[25] + d[5] * d[6] * d[27] - 2 * d[3] * d[8] * d[27] + d[5] * d[7] * d[28] +
                 d[3] * d[6] * d[29] + d[4] * d[7] * d[29] + d[3] * d[5] * d[30] + d[4] * d[5] * d[31] +
                 2 * d[7] * d[8] * d[31] + d[1] * d[1] * d[32] - d[3] * d[3] * d[32] + d[7] * d[7] * d[32];
    coeffs[100] = 2 * d[8] * d[13] * d[25] + 2 * d[1] * d[20] * d[25] - 2 * d[8] * d[15] * d[27] +
                  d[6] * d[17] * d[27] + d[5] * d[18] * d[27] - 2 * d[3] * d[20] * d[27] + d[7] * d[17] * d[28] +
                  d[5] * d[19] * d[28] + d[6] * d[15] * d[29] + d[7] * d[16] * d[29] + d[3] * d[18] * d[29] +
                  d[4] * d[19] * d[29] + d[5] * d[15] * d[30] + d[3] * d[17] * d[30] + d[5] * d[16] * d[31] +
                  d[4] * d[17] * d[31] + 2 * d[8] * d[19] * d[31] + 2 * d[7] * d[20] * d[31] +
                  2 * d[1] * d[13] * d[32] - 2 * d[3] * d[15] * d[32] + 2 * d[7] * d[19] * d[32];
    coeffs[101] = 2 * d[13] * d[20] * d[25] + d[17] * d[18] * d[27] - 2 * d[15] * d[20] * d[27] +
                  d[17] * d[19] * d[28] + d[15] * d[18] * d[29] + d[16] * d[19] * d[29] + d[15] * d[17] * d[30] +
                  d[16] * d[17] * d[31] + 2 * d[19] * d[20] * d[31] + d[13] * d[13] * d[32] - d[15] * d[15] * d[32] +
                  d[19] * d[19] * d[32];
    coeffs[102] = d[8] * d[25] * d[25] - d[8] * d[27] * d[27] + d[6] * d[27] * d[29] + d[7] * d[28] * d[29] +
                  d[5] * d[27] * d[30] + d[3] * d[29] * d[30] + d[5] * d[28] * d[31] + d[4] * d[29] * d[31] +
                  d[8] * d[31] * d[31] + 2 * d[1] * d[25] * d[32] - 2 * d[3] * d[27] * d[32] + 2 * d[7] * d[31] * d[32];
    coeffs[103] = d[20] * d[25] * d[25] - d[20] * d[27] * d[27] + d[18] * d[27] * d[29] + d[19] * d[28] * d[29] +
                  d[17] * d[27] * d[30] + d[15] * d[29] * d[30] + d[17] * d[28] * d[31] + d[16] * d[29] * d[31] +
                  d[20] * d[31] * d[31] + 2 * d[13] * d[25] * d[32] - 2 * d[15] * d[27] * d[32] +
                  2 * d[19] * d[31] * d[32];
    coeffs[104] = d[27] * d[29] * d[30] + d[28] * d[29] * d[31] + d[25] * d[25] * d[32] - d[27] * d[27] * d[32] +
                  d[31] * d[31] * d[32];
    coeffs[105] = 2 * d[1] * d[8] * d[37] + d[5] * d[6] * d[39] - 2 * d[3] * d[8] * d[39] + d[5] * d[7] * d[40] +
                  d[3] * d[6] * d[41] + d[4] * d[7] * d[41] + d[3] * d[5] * d[42] + d[4] * d[5] * d[43] +
                  2 * d[7] * d[8] * d[43] + d[1] * d[1] * d[44] - d[3] * d[3] * d[44] + d[7] * d[7] * d[44];
    coeffs[106] = 2 * d[8] * d[13] * d[37] + 2 * d[1] * d[20] * d[37] - 2 * d[8] * d[15] * d[39] +
                  d[6] * d[17] * d[39] + d[5] * d[18] * d[39] - 2 * d[3] * d[20] * d[39] + d[7] * d[17] * d[40] +
                  d[5] * d[19] * d[40] + d[6] * d[15] * d[41] + d[7] * d[16] * d[41] + d[3] * d[18] * d[41] +
                  d[4] * d[19] * d[41] + d[5] * d[15] * d[42] + d[3] * d[17] * d[42] + d[5] * d[16] * d[43] +
                  d[4] * d[17] * d[43] + 2 * d[8] * d[19] * d[43] + 2 * d[7] * d[20] * d[43] +
                  2 * d[1] * d[13] * d[44] - 2 * d[3] * d[15] * d[44] + 2 * d[7] * d[19] * d[44];
    coeffs[107] = 2 * d[13] * d[20] * d[37] + d[17] * d[18] * d[39] - 2 * d[15] * d[20] * d[39] +
                  d[17] * d[19] * d[40] + d[15] * d[18] * d[41] + d[16] * d[19] * d[41] + d[15] * d[17] * d[42] +
                  d[16] * d[17] * d[43] + 2 * d[19] * d[20] * d[43] + d[13] * d[13] * d[44] - d[15] * d[15] * d[44] +
                  d[19] * d[19] * d[44];
    coeffs[108] = 2 * d[8] * d[25] * d[37] + 2 * d[1] * d[32] * d[37] - 2 * d[8] * d[27] * d[39] +
                  d[6] * d[29] * d[39] + d[5] * d[30] * d[39] - 2 * d[3] * d[32] * d[39] + d[7] * d[29] * d[40] +
                  d[5] * d[31] * d[40] + d[6] * d[27] * d[41] + d[7] * d[28] * d[41] + d[3] * d[30] * d[41] +
                  d[4] * d[31] * d[41] + d[5] * d[27] * d[42] + d[3] * d[29] * d[42] + d[5] * d[28] * d[43] +
                  d[4] * d[29] * d[43] + 2 * d[8] * d[31] * d[43] + 2 * d[7] * d[32] * d[43] +
                  2 * d[1] * d[25] * d[44] - 2 * d[3] * d[27] * d[44] + 2 * d[7] * d[31] * d[44];
    coeffs[109] = 2 * d[20] * d[25] * d[37] + 2 * d[13] * d[32] * d[37] - 2 * d[20] * d[27] * d[39] +
                  d[18] * d[29] * d[39] + d[17] * d[30] * d[39] - 2 * d[15] * d[32] * d[39] + d[19] * d[29] * d[40] +
                  d[17] * d[31] * d[40] + d[18] * d[27] * d[41] + d[19] * d[28] * d[41] + d[15] * d[30] * d[41] +
                  d[16] * d[31] * d[41] + d[17] * d[27] * d[42] + d[15] * d[29] * d[42] + d[17] * d[28] * d[43] +
                  d[16] * d[29] * d[43] + 2 * d[20] * d[31] * d[43] + 2 * d[19] * d[32] * d[43] +
                  2 * d[13] * d[25] * d[44] - 2 * d[15] * d[27] * d[44] + 2 * d[19] * d[31] * d[44];
    coeffs[110] = 2 * d[25] * d[32] * d[37] + d[29] * d[30] * d[39] - 2 * d[27] * d[32] * d[39] +
                  d[29] * d[31] * d[40] + d[27] * d[30] * d[41] + d[28] * d[31] * d[41] + d[27] * d[29] * d[42] +
                  d[28] * d[29] * d[43] + 2 * d[31] * d[32] * d[43] + d[25] * d[25] * d[44] - d[27] * d[27] * d[44] +
                  d[31] * d[31] * d[44];
    coeffs[111] = d[8] * d[37] * d[37] - d[8] * d[39] * d[39] + d[6] * d[39] * d[41] + d[7] * d[40] * d[41] +
                  d[5] * d[39] * d[42] + d[3] * d[41] * d[42] + d[5] * d[40] * d[43] + d[4] * d[41] * d[43] +
                  d[8] * d[43] * d[43] + 2 * d[1] * d[37] * d[44] - 2 * d[3] * d[39] * d[44] + 2 * d[7] * d[43] * d[44];
    coeffs[112] = d[20] * d[37] * d[37] - d[20] * d[39] * d[39] + d[18] * d[39] * d[41] + d[19] * d[40] * d[41] +
                  d[17] * d[39] * d[42] + d[15] * d[41] * d[42] + d[17] * d[40] * d[43] + d[16] * d[41] * d[43] +
                  d[20] * d[43] * d[43] + 2 * d[13] * d[37] * d[44] - 2 * d[15] * d[39] * d[44] +
                  2 * d[19] * d[43] * d[44];
    coeffs[113] = d[32] * d[37] * d[37] - d[32] * d[39] * d[39] + d[30] * d[39] * d[41] + d[31] * d[40] * d[41] +
                  d[29] * d[39] * d[42] + d[27] * d[41] * d[42] + d[29] * d[40] * d[43] + d[28] * d[41] * d[43] +
                  d[32] * d[43] * d[43] + 2 * d[25] * d[37] * d[44] - 2 * d[27] * d[39] * d[44] +
                  2 * d[31] * d[43] * d[44];
    coeffs[114] = d[39] * d[41] * d[42] + d[40] * d[41] * d[43] + d[37] * d[37] * d[44] - d[39] * d[39] * d[44] +
                  d[43] * d[43] * d[44];
    coeffs[115] = 2 * d[1] * d[8] * d[49] + d[5] * d[6] * d[51] - 2 * d[3] * d[8] * d[51] + d[5] * d[7] * d[52] +
                  d[3] * d[6] * d[53] + d[4] * d[7] * d[53] + d[3] * d[5] * d[54] + d[4] * d[5] * d[55] +
                  2 * d[7] * d[8] * d[55] + d[1] * d[1] * d[56] - d[3] * d[3] * d[56] + d[7] * d[7] * d[56];
    coeffs[116] = 2 * d[8] * d[13] * d[49] + 2 * d[1] * d[20] * d[49] - 2 * d[8] * d[15] * d[51] +
                  d[6] * d[17] * d[51] + d[5] * d[18] * d[51] - 2 * d[3] * d[20] * d[51] + d[7] * d[17] * d[52] +
                  d[5] * d[19] * d[52] + d[6] * d[15] * d[53] + d[7] * d[16] * d[53] + d[3] * d[18] * d[53] +
                  d[4] * d[19] * d[53] + d[5] * d[15] * d[54] + d[3] * d[17] * d[54] + d[5] * d[16] * d[55] +
                  d[4] * d[17] * d[55] + 2 * d[8] * d[19] * d[55] + 2 * d[7] * d[20] * d[55] +
                  2 * d[1] * d[13] * d[56] - 2 * d[3] * d[15] * d[56] + 2 * d[7] * d[19] * d[56];
    coeffs[117] = 2 * d[13] * d[20] * d[49] + d[17] * d[18] * d[51] - 2 * d[15] * d[20] * d[51] +
                  d[17] * d[19] * d[52] + d[15] * d[18] * d[53] + d[16] * d[19] * d[53] + d[15] * d[17] * d[54] +
                  d[16] * d[17] * d[55] + 2 * d[19] * d[20] * d[55] + d[13] * d[13] * d[56] - d[15] * d[15] * d[56] +
                  d[19] * d[19] * d[56];
    coeffs[118] = 2 * d[8] * d[25] * d[49] + 2 * d[1] * d[32] * d[49] - 2 * d[8] * d[27] * d[51] +
                  d[6] * d[29] * d[51] + d[5] * d[30] * d[51] - 2 * d[3] * d[32] * d[51] + d[7] * d[29] * d[52] +
                  d[5] * d[31] * d[52] + d[6] * d[27] * d[53] + d[7] * d[28] * d[53] + d[3] * d[30] * d[53] +
                  d[4] * d[31] * d[53] + d[5] * d[27] * d[54] + d[3] * d[29] * d[54] + d[5] * d[28] * d[55] +
                  d[4] * d[29] * d[55] + 2 * d[8] * d[31] * d[55] + 2 * d[7] * d[32] * d[55] +
                  2 * d[1] * d[25] * d[56] - 2 * d[3] * d[27] * d[56] + 2 * d[7] * d[31] * d[56];
    coeffs[119] = 2 * d[20] * d[25] * d[49] + 2 * d[13] * d[32] * d[49] - 2 * d[20] * d[27] * d[51] +
                  d[18] * d[29] * d[51] + d[17] * d[30] * d[51] - 2 * d[15] * d[32] * d[51] + d[19] * d[29] * d[52] +
                  d[17] * d[31] * d[52] + d[18] * d[27] * d[53] + d[19] * d[28] * d[53] + d[15] * d[30] * d[53] +
                  d[16] * d[31] * d[53] + d[17] * d[27] * d[54] + d[15] * d[29] * d[54] + d[17] * d[28] * d[55] +
                  d[16] * d[29] * d[55] + 2 * d[20] * d[31] * d[55] + 2 * d[19] * d[32] * d[55] +
                  2 * d[13] * d[25] * d[56] - 2 * d[15] * d[27] * d[56] + 2 * d[19] * d[31] * d[56];
    coeffs[120] = 2 * d[25] * d[32] * d[49] + d[29] * d[30] * d[51] - 2 * d[27] * d[32] * d[51] +
                  d[29] * d[31] * d[52] + d[27] * d[30] * d[53] + d[28] * d[31] * d[53] + d[27] * d[29] * d[54] +
                  d[28] * d[29] * d[55] + 2 * d[31] * d[32] * d[55] + d[25] * d[25] * d[56] - d[27] * d[27] * d[56] +
                  d[31] * d[31] * d[56];
    coeffs[121] = 2 * d[8] * d[37] * d[49] + 2 * d[1] * d[44] * d[49] - 2 * d[8] * d[39] * d[51] +
                  d[6] * d[41] * d[51] + d[5] * d[42] * d[51] - 2 * d[3] * d[44] * d[51] + d[7] * d[41] * d[52] +
                  d[5] * d[43] * d[52] + d[6] * d[39] * d[53] + d[7] * d[40] * d[53] + d[3] * d[42] * d[53] +
                  d[4] * d[43] * d[53] + d[5] * d[39] * d[54] + d[3] * d[41] * d[54] + d[5] * d[40] * d[55] +
                  d[4] * d[41] * d[55] + 2 * d[8] * d[43] * d[55] + 2 * d[7] * d[44] * d[55] +
                  2 * d[1] * d[37] * d[56] - 2 * d[3] * d[39] * d[56] + 2 * d[7] * d[43] * d[56];
    coeffs[122] = 2 * d[20] * d[37] * d[49] + 2 * d[13] * d[44] * d[49] - 2 * d[20] * d[39] * d[51] +
                  d[18] * d[41] * d[51] + d[17] * d[42] * d[51] - 2 * d[15] * d[44] * d[51] + d[19] * d[41] * d[52] +
                  d[17] * d[43] * d[52] + d[18] * d[39] * d[53] + d[19] * d[40] * d[53] + d[15] * d[42] * d[53] +
                  d[16] * d[43] * d[53] + d[17] * d[39] * d[54] + d[15] * d[41] * d[54] + d[17] * d[40] * d[55] +
                  d[16] * d[41] * d[55] + 2 * d[20] * d[43] * d[55] + 2 * d[19] * d[44] * d[55] +
                  2 * d[13] * d[37] * d[56] - 2 * d[15] * d[39] * d[56] + 2 * d[19] * d[43] * d[56];
    coeffs[123] = 2 * d[32] * d[37] * d[49] + 2 * d[25] * d[44] * d[49] - 2 * d[32] * d[39] * d[51] +
                  d[30] * d[41] * d[51] + d[29] * d[42] * d[51] - 2 * d[27] * d[44] * d[51] + d[31] * d[41] * d[52] +
                  d[29] * d[43] * d[52] + d[30] * d[39] * d[53] + d[31] * d[40] * d[53] + d[27] * d[42] * d[53] +
                  d[28] * d[43] * d[53] + d[29] * d[39] * d[54] + d[27] * d[41] * d[54] + d[29] * d[40] * d[55] +
                  d[28] * d[41] * d[55] + 2 * d[32] * d[43] * d[55] + 2 * d[31] * d[44] * d[55] +
                  2 * d[25] * d[37] * d[56] - 2 * d[27] * d[39] * d[56] + 2 * d[31] * d[43] * d[56];
    coeffs[124] = 2 * d[37] * d[44] * d[49] + d[41] * d[42] * d[51] - 2 * d[39] * d[44] * d[51] +
                  d[41] * d[43] * d[52] + d[39] * d[42] * d[53] + d[40] * d[43] * d[53] + d[39] * d[41] * d[54] +
                  d[40] * d[41] * d[55] + 2 * d[43] * d[44] * d[55] + d[37] * d[37] * d[56] - d[39] * d[39] * d[56] +
                  d[43] * d[43] * d[56];
    coeffs[125] = d[8] * d[49] * d[49] - d[8] * d[51] * d[51] + d[6] * d[51] * d[53] + d[7] * d[52] * d[53] +
                  d[5] * d[51] * d[54] + d[3] * d[53] * d[54] + d[5] * d[52] * d[55] + d[4] * d[53] * d[55] +
                  d[8] * d[55] * d[55] + 2 * d[1] * d[49] * d[56] - 2 * d[3] * d[51] * d[56] + 2 * d[7] * d[55] * d[56];
    coeffs[126] = d[20] * d[49] * d[49] - d[20] * d[51] * d[51] + d[18] * d[51] * d[53] + d[19] * d[52] * d[53] +
                  d[17] * d[51] * d[54] + d[15] * d[53] * d[54] + d[17] * d[52] * d[55] + d[16] * d[53] * d[55] +
                  d[20] * d[55] * d[55] + 2 * d[13] * d[49] * d[56] - 2 * d[15] * d[51] * d[56] +
                  2 * d[19] * d[55] * d[56];
    coeffs[127] = d[32] * d[49] * d[49] - d[32] * d[51] * d[51] + d[30] * d[51] * d[53] + d[31] * d[52] * d[53] +
                  d[29] * d[51] * d[54] + d[27] * d[53] * d[54] + d[29] * d[52] * d[55] + d[28] * d[53] * d[55] +
                  d[32] * d[55] * d[55] + 2 * d[25] * d[49] * d[56] - 2 * d[27] * d[51] * d[56] +
                  2 * d[31] * d[55] * d[56];
    coeffs[128] = d[44] * d[49] * d[49] - d[44] * d[51] * d[51] + d[42] * d[51] * d[53] + d[43] * d[52] * d[53] +
                  d[41] * d[51] * d[54] + d[39] * d[53] * d[54] + d[41] * d[52] * d[55] + d[40] * d[53] * d[55] +
                  d[44] * d[55] * d[55] + 2 * d[37] * d[49] * d[56] - 2 * d[39] * d[51] * d[56] +
                  2 * d[43] * d[55] * d[56];
    coeffs[129] = d[51] * d[53] * d[54] + d[52] * d[53] * d[55] + d[49] * d[49] * d[56] - d[51] * d[51] * d[56] +
                  d[55] * d[55] * d[56];
    coeffs[130] = d[0] * d[5] * d[6] + d[1] * d[5] * d[7] - d[0] * d[3] * d[8] - d[1] * d[4] * d[8];
    coeffs[131] = d[5] * d[6] * d[12] - d[3] * d[8] * d[12] + d[5] * d[7] * d[13] - d[4] * d[8] * d[13] -
                  d[0] * d[8] * d[15] - d[1] * d[8] * d[16] + d[0] * d[6] * d[17] + d[1] * d[7] * d[17] +
                  d[0] * d[5] * d[18] + d[1] * d[5] * d[19] - d[0] * d[3] * d[20] - d[1] * d[4] * d[20];
    coeffs[132] = -d[8] * d[12] * d[15] - d[8] * d[13] * d[16] + d[6] * d[12] * d[17] + d[7] * d[13] * d[17] +
                  d[5] * d[12] * d[18] + d[0] * d[17] * d[18] + d[5] * d[13] * d[19] + d[1] * d[17] * d[19] -
                  d[3] * d[12] * d[20] - d[4] * d[13] * d[20] - d[0] * d[15] * d[20] - d[1] * d[16] * d[20];
    coeffs[133] = d[12] * d[17] * d[18] + d[13] * d[17] * d[19] - d[12] * d[15] * d[20] - d[13] * d[16] * d[20];
    coeffs[134] = d[5] * d[6] * d[24] - d[3] * d[8] * d[24] + d[5] * d[7] * d[25] - d[4] * d[8] * d[25] -
                  d[0] * d[8] * d[27] - d[1] * d[8] * d[28] + d[0] * d[6] * d[29] + d[1] * d[7] * d[29] +
                  d[0] * d[5] * d[30] + d[1] * d[5] * d[31] - d[0] * d[3] * d[32] - d[1] * d[4] * d[32];
    coeffs[135] = -d[8] * d[15] * d[24] + d[6] * d[17] * d[24] + d[5] * d[18] * d[24] - d[3] * d[20] * d[24] -
                  d[8] * d[16] * d[25] + d[7] * d[17] * d[25] + d[5] * d[19] * d[25] - d[4] * d[20] * d[25] -
                  d[8] * d[12] * d[27] - d[0] * d[20] * d[27] - d[8] * d[13] * d[28] - d[1] * d[20] * d[28] +
                  d[6] * d[12] * d[29] + d[7] * d[13] * d[29] + d[0] * d[18] * d[29] + d[1] * d[19] * d[29] +
                  d[5] * d[12] * d[30] + d[0] * d[17] * d[30] + d[5] * d[13] * d[31] + d[1] * d[17] * d[31] -
                  d[3] * d[12] * d[32] - d[4] * d[13] * d[32] - d[0] * d[15] * d[32] - d[1] * d[16] * d[32];
    coeffs[136] = d[17] * d[18] * d[24] - d[15] * d[20] * d[24] + d[17] * d[19] * d[25] - d[16] * d[20] * d[25] -
                  d[12] * d[20] * d[27] - d[13] * d[20] * d[28] + d[12] * d[18] * d[29] + d[13] * d[19] * d[29] +
                  d[12] * d[17] * d[30] + d[13] * d[17] * d[31] - d[12] * d[15] * d[32] - d[13] * d[16] * d[32];
    coeffs[137] = -d[8] * d[24] * d[27] - d[8] * d[25] * d[28] + d[6] * d[24] * d[29] + d[7] * d[25] * d[29] +
                  d[5] * d[24] * d[30] + d[0] * d[29] * d[30] + d[5] * d[25] * d[31] + d[1] * d[29] * d[31] -
                  d[3] * d[24] * d[32] - d[4] * d[25] * d[32] - d[0] * d[27] * d[32] - d[1] * d[28] * d[32];
    coeffs[138] = -d[20] * d[24] * d[27] - d[20] * d[25] * d[28] + d[18] * d[24] * d[29] + d[19] * d[25] * d[29] +
                  d[17] * d[24] * d[30] + d[12] * d[29] * d[30] + d[17] * d[25] * d[31] + d[13] * d[29] * d[31] -
                  d[15] * d[24] * d[32] - d[16] * d[25] * d[32] - d[12] * d[27] * d[32] - d[13] * d[28] * d[32];
    coeffs[139] = d[24] * d[29] * d[30] + d[25] * d[29] * d[31] - d[24] * d[27] * d[32] - d[25] * d[28] * d[32];
    coeffs[140] = d[5] * d[6] * d[36] - d[3] * d[8] * d[36] + d[5] * d[7] * d[37] - d[4] * d[8] * d[37] -
                  d[0] * d[8] * d[39] - d[1] * d[8] * d[40] + d[0] * d[6] * d[41] + d[1] * d[7] * d[41] +
                  d[0] * d[5] * d[42] + d[1] * d[5] * d[43] - d[0] * d[3] * d[44] - d[1] * d[4] * d[44];
    coeffs[141] = -d[8] * d[15] * d[36] + d[6] * d[17] * d[36] + d[5] * d[18] * d[36] - d[3] * d[20] * d[36] -
                  d[8] * d[16] * d[37] + d[7] * d[17] * d[37] + d[5] * d[19] * d[37] - d[4] * d[20] * d[37] -
                  d[8] * d[12] * d[39] - d[0] * d[20] * d[39] - d[8] * d[13] * d[40] - d[1] * d[20] * d[40] +
                  d[6] * d[12] * d[41] + d[7] * d[13] * d[41] + d[0] * d[18] * d[41] + d[1] * d[19] * d[41] +
                  d[5] * d[12] * d[42] + d[0] * d[17] * d[42] + d[5] * d[13] * d[43] + d[1] * d[17] * d[43] -
                  d[3] * d[12] * d[44] - d[4] * d[13] * d[44] - d[0] * d[15] * d[44] - d[1] * d[16] * d[44];
    coeffs[142] = d[17] * d[18] * d[36] - d[15] * d[20] * d[36] + d[17] * d[19] * d[37] - d[16] * d[20] * d[37] -
                  d[12] * d[20] * d[39] - d[13] * d[20] * d[40] + d[12] * d[18] * d[41] + d[13] * d[19] * d[41] +
                  d[12] * d[17] * d[42] + d[13] * d[17] * d[43] - d[12] * d[15] * d[44] - d[13] * d[16] * d[44];
    coeffs[143] = -d[8] * d[27] * d[36] + d[6] * d[29] * d[36] + d[5] * d[30] * d[36] - d[3] * d[32] * d[36] -
                  d[8] * d[28] * d[37] + d[7] * d[29] * d[37] + d[5] * d[31] * d[37] - d[4] * d[32] * d[37] -
                  d[8] * d[24] * d[39] - d[0] * d[32] * d[39] - d[8] * d[25] * d[40] - d[1] * d[32] * d[40] +
                  d[6] * d[24] * d[41] + d[7] * d[25] * d[41] + d[0] * d[30] * d[41] + d[1] * d[31] * d[41] +
                  d[5] * d[24] * d[42] + d[0] * d[29] * d[42] + d[5] * d[25] * d[43] + d[1] * d[29] * d[43] -
                  d[3] * d[24] * d[44] - d[4] * d[25] * d[44] - d[0] * d[27] * d[44] - d[1] * d[28] * d[44];
    coeffs[144] = -d[20] * d[27] * d[36] + d[18] * d[29] * d[36] + d[17] * d[30] * d[36] - d[15] * d[32] * d[36] -
                  d[20] * d[28] * d[37] + d[19] * d[29] * d[37] + d[17] * d[31] * d[37] - d[16] * d[32] * d[37] -
                  d[20] * d[24] * d[39] - d[12] * d[32] * d[39] - d[20] * d[25] * d[40] - d[13] * d[32] * d[40] +
                  d[18] * d[24] * d[41] + d[19] * d[25] * d[41] + d[12] * d[30] * d[41] + d[13] * d[31] * d[41] +
                  d[17] * d[24] * d[42] + d[12] * d[29] * d[42] + d[17] * d[25] * d[43] + d[13] * d[29] * d[43] -
                  d[15] * d[24] * d[44] - d[16] * d[25] * d[44] - d[12] * d[27] * d[44] - d[13] * d[28] * d[44];
    coeffs[145] = d[29] * d[30] * d[36] - d[27] * d[32] * d[36] + d[29] * d[31] * d[37] - d[28] * d[32] * d[37] -
                  d[24] * d[32] * d[39] - d[25] * d[32] * d[40] + d[24] * d[30] * d[41] + d[25] * d[31] * d[41] +
                  d[24] * d[29] * d[42] + d[25] * d[29] * d[43] - d[24] * d[27] * d[44] - d[25] * d[28] * d[44];
    coeffs[146] = -d[8] * d[36] * d[39] - d[8] * d[37] * d[40] + d[6] * d[36] * d[41] + d[7] * d[37] * d[41] +
                  d[5] * d[36] * d[42] + d[0] * d[41] * d[42] + d[5] * d[37] * d[43] + d[1] * d[41] * d[43] -
                  d[3] * d[36] * d[44] - d[4] * d[37] * d[44] - d[0] * d[39] * d[44] - d[1] * d[40] * d[44];
    coeffs[147] = -d[20] * d[36] * d[39] - d[20] * d[37] * d[40] + d[18] * d[36] * d[41] + d[19] * d[37] * d[41] +
                  d[17] * d[36] * d[42] + d[12] * d[41] * d[42] + d[17] * d[37] * d[43] + d[13] * d[41] * d[43] -
                  d[15] * d[36] * d[44] - d[16] * d[37] * d[44] - d[12] * d[39] * d[44] - d[13] * d[40] * d[44];
    coeffs[148] = -d[32] * d[36] * d[39] - d[32] * d[37] * d[40] + d[30] * d[36] * d[41] + d[31] * d[37] * d[41] +
                  d[29] * d[36] * d[42] + d[24] * d[41] * d[42] + d[29] * d[37] * d[43] + d[25] * d[41] * d[43] -
                  d[27] * d[36] * d[44] - d[28] * d[37] * d[44] - d[24] * d[39] * d[44] - d[25] * d[40] * d[44];
    coeffs[149] = d[36] * d[41] * d[42] + d[37] * d[41] * d[43] - d[36] * d[39] * d[44] - d[37] * d[40] * d[44];
    coeffs[150] = d[5] * d[6] * d[48] - d[3] * d[8] * d[48] + d[5] * d[7] * d[49] - d[4] * d[8] * d[49] -
                  d[0] * d[8] * d[51] - d[1] * d[8] * d[52] + d[0] * d[6] * d[53] + d[1] * d[7] * d[53] +
                  d[0] * d[5] * d[54] + d[1] * d[5] * d[55] - d[0] * d[3] * d[56] - d[1] * d[4] * d[56];
    coeffs[151] = -d[8] * d[15] * d[48] + d[6] * d[17] * d[48] + d[5] * d[18] * d[48] - d[3] * d[20] * d[48] -
                  d[8] * d[16] * d[49] + d[7] * d[17] * d[49] + d[5] * d[19] * d[49] - d[4] * d[20] * d[49] -
                  d[8] * d[12] * d[51] - d[0] * d[20] * d[51] - d[8] * d[13] * d[52] - d[1] * d[20] * d[52] +
                  d[6] * d[12] * d[53] + d[7] * d[13] * d[53] + d[0] * d[18] * d[53] + d[1] * d[19] * d[53] +
                  d[5] * d[12] * d[54] + d[0] * d[17] * d[54] + d[5] * d[13] * d[55] + d[1] * d[17] * d[55] -
                  d[3] * d[12] * d[56] - d[4] * d[13] * d[56] - d[0] * d[15] * d[56] - d[1] * d[16] * d[56];
    coeffs[152] = d[17] * d[18] * d[48] - d[15] * d[20] * d[48] + d[17] * d[19] * d[49] - d[16] * d[20] * d[49] -
                  d[12] * d[20] * d[51] - d[13] * d[20] * d[52] + d[12] * d[18] * d[53] + d[13] * d[19] * d[53] +
                  d[12] * d[17] * d[54] + d[13] * d[17] * d[55] - d[12] * d[15] * d[56] - d[13] * d[16] * d[56];
    coeffs[153] = -d[8] * d[27] * d[48] + d[6] * d[29] * d[48] + d[5] * d[30] * d[48] - d[3] * d[32] * d[48] -
                  d[8] * d[28] * d[49] + d[7] * d[29] * d[49] + d[5] * d[31] * d[49] - d[4] * d[32] * d[49] -
                  d[8] * d[24] * d[51] - d[0] * d[32] * d[51] - d[8] * d[25] * d[52] - d[1] * d[32] * d[52] +
                  d[6] * d[24] * d[53] + d[7] * d[25] * d[53] + d[0] * d[30] * d[53] + d[1] * d[31] * d[53] +
                  d[5] * d[24] * d[54] + d[0] * d[29] * d[54] + d[5] * d[25] * d[55] + d[1] * d[29] * d[55] -
                  d[3] * d[24] * d[56] - d[4] * d[25] * d[56] - d[0] * d[27] * d[56] - d[1] * d[28] * d[56];
    coeffs[154] = -d[20] * d[27] * d[48] + d[18] * d[29] * d[48] + d[17] * d[30] * d[48] - d[15] * d[32] * d[48] -
                  d[20] * d[28] * d[49] + d[19] * d[29] * d[49] + d[17] * d[31] * d[49] - d[16] * d[32] * d[49] -
                  d[20] * d[24] * d[51] - d[12] * d[32] * d[51] - d[20] * d[25] * d[52] - d[13] * d[32] * d[52] +
                  d[18] * d[24] * d[53] + d[19] * d[25] * d[53] + d[12] * d[30] * d[53] + d[13] * d[31] * d[53] +
                  d[17] * d[24] * d[54] + d[12] * d[29] * d[54] + d[17] * d[25] * d[55] + d[13] * d[29] * d[55] -
                  d[15] * d[24] * d[56] - d[16] * d[25] * d[56] - d[12] * d[27] * d[56] - d[13] * d[28] * d[56];
    coeffs[155] = d[29] * d[30] * d[48] - d[27] * d[32] * d[48] + d[29] * d[31] * d[49] - d[28] * d[32] * d[49] -
                  d[24] * d[32] * d[51] - d[25] * d[32] * d[52] + d[24] * d[30] * d[53] + d[25] * d[31] * d[53] +
                  d[24] * d[29] * d[54] + d[25] * d[29] * d[55] - d[24] * d[27] * d[56] - d[25] * d[28] * d[56];
    coeffs[156] = -d[8] * d[39] * d[48] + d[6] * d[41] * d[48] + d[5] * d[42] * d[48] - d[3] * d[44] * d[48] -
                  d[8] * d[40] * d[49] + d[7] * d[41] * d[49] + d[5] * d[43] * d[49] - d[4] * d[44] * d[49] -
                  d[8] * d[36] * d[51] - d[0] * d[44] * d[51] - d[8] * d[37] * d[52] - d[1] * d[44] * d[52] +
                  d[6] * d[36] * d[53] + d[7] * d[37] * d[53] + d[0] * d[42] * d[53] + d[1] * d[43] * d[53] +
                  d[5] * d[36] * d[54] + d[0] * d[41] * d[54] + d[5] * d[37] * d[55] + d[1] * d[41] * d[55] -
                  d[3] * d[36] * d[56] - d[4] * d[37] * d[56] - d[0] * d[39] * d[56] - d[1] * d[40] * d[56];
    coeffs[157] = -d[20] * d[39] * d[48] + d[18] * d[41] * d[48] + d[17] * d[42] * d[48] - d[15] * d[44] * d[48] -
                  d[20] * d[40] * d[49] + d[19] * d[41] * d[49] + d[17] * d[43] * d[49] - d[16] * d[44] * d[49] -
                  d[20] * d[36] * d[51] - d[12] * d[44] * d[51] - d[20] * d[37] * d[52] - d[13] * d[44] * d[52] +
                  d[18] * d[36] * d[53] + d[19] * d[37] * d[53] + d[12] * d[42] * d[53] + d[13] * d[43] * d[53] +
                  d[17] * d[36] * d[54] + d[12] * d[41] * d[54] + d[17] * d[37] * d[55] + d[13] * d[41] * d[55] -
                  d[15] * d[36] * d[56] - d[16] * d[37] * d[56] - d[12] * d[39] * d[56] - d[13] * d[40] * d[56];
    coeffs[158] = -d[32] * d[39] * d[48] + d[30] * d[41] * d[48] + d[29] * d[42] * d[48] - d[27] * d[44] * d[48] -
                  d[32] * d[40] * d[49] + d[31] * d[41] * d[49] + d[29] * d[43] * d[49] - d[28] * d[44] * d[49] -
                  d[32] * d[36] * d[51] - d[24] * d[44] * d[51] - d[32] * d[37] * d[52] - d[25] * d[44] * d[52] +
                  d[30] * d[36] * d[53] + d[31] * d[37] * d[53] + d[24] * d[42] * d[53] + d[25] * d[43] * d[53] +
                  d[29] * d[36] * d[54] + d[24] * d[41] * d[54] + d[29] * d[37] * d[55] + d[25] * d[41] * d[55] -
                  d[27] * d[36] * d[56] - d[28] * d[37] * d[56] - d[24] * d[39] * d[56] - d[25] * d[40] * d[56];
    coeffs[159] = d[41] * d[42] * d[48] - d[39] * d[44] * d[48] + d[41] * d[43] * d[49] - d[40] * d[44] * d[49] -
                  d[36] * d[44] * d[51] - d[37] * d[44] * d[52] + d[36] * d[42] * d[53] + d[37] * d[43] * d[53] +
                  d[36] * d[41] * d[54] + d[37] * d[41] * d[55] - d[36] * d[39] * d[56] - d[37] * d[40] * d[56];
    coeffs[160] = -d[8] * d[48] * d[51] - d[8] * d[49] * d[52] + d[6] * d[48] * d[53] + d[7] * d[49] * d[53] +
                  d[5] * d[48] * d[54] + d[0] * d[53] * d[54] + d[5] * d[49] * d[55] + d[1] * d[53] * d[55] -
                  d[3] * d[48] * d[56] - d[4] * d[49] * d[56] - d[0] * d[51] * d[56] - d[1] * d[52] * d[56];
    coeffs[161] = -d[20] * d[48] * d[51] - d[20] * d[49] * d[52] + d[18] * d[48] * d[53] + d[19] * d[49] * d[53] +
                  d[17] * d[48] * d[54] + d[12] * d[53] * d[54] + d[17] * d[49] * d[55] + d[13] * d[53] * d[55] -
                  d[15] * d[48] * d[56] - d[16] * d[49] * d[56] - d[12] * d[51] * d[56] - d[13] * d[52] * d[56];
    coeffs[162] = -d[32] * d[48] * d[51] - d[32] * d[49] * d[52] + d[30] * d[48] * d[53] + d[31] * d[49] * d[53] +
                  d[29] * d[48] * d[54] + d[24] * d[53] * d[54] + d[29] * d[49] * d[55] + d[25] * d[53] * d[55] -
                  d[27] * d[48] * d[56] - d[28] * d[49] * d[56] - d[24] * d[51] * d[56] - d[25] * d[52] * d[56];
    coeffs[163] = -d[44] * d[48] * d[51] - d[44] * d[49] * d[52] + d[42] * d[48] * d[53] + d[43] * d[49] * d[53] +
                  d[41] * d[48] * d[54] + d[36] * d[53] * d[54] + d[41] * d[49] * d[55] + d[37] * d[53] * d[55] -
                  d[39] * d[48] * d[56] - d[40] * d[49] * d[56] - d[36] * d[51] * d[56] - d[37] * d[52] * d[56];
    coeffs[164] = d[48] * d[53] * d[54] + d[49] * d[53] * d[55] - d[48] * d[51] * d[56] - d[49] * d[52] * d[56];
    coeffs[165] = -d[2] * d[4] * d[4] + d[1] * d[4] * d[5] + d[2] * d[6] * d[6] - d[0] * d[6] * d[8];
    coeffs[166] = -d[6] * d[8] * d[12] + d[4] * d[5] * d[13] - d[4] * d[4] * d[14] + d[6] * d[6] * d[14] -
                  2 * d[2] * d[4] * d[16] + d[1] * d[5] * d[16] + d[1] * d[4] * d[17] + 2 * d[2] * d[6] * d[18] -
                  d[0] * d[8] * d[18] - d[0] * d[6] * d[20];
    coeffs[167] = d[5] * d[13] * d[16] - 2 * d[4] * d[14] * d[16] - d[2] * d[16] * d[16] + d[4] * d[13] * d[17] +
                  d[1] * d[16] * d[17] - d[8] * d[12] * d[18] + 2 * d[6] * d[14] * d[18] + d[2] * d[18] * d[18] -
                  d[6] * d[12] * d[20] - d[0] * d[18] * d[20];
    coeffs[168] = -d[14] * d[16] * d[16] + d[13] * d[16] * d[17] + d[14] * d[18] * d[18] - d[12] * d[18] * d[20];
    coeffs[169] = -d[6] * d[8] * d[24] + d[4] * d[5] * d[25] - d[4] * d[4] * d[26] + d[6] * d[6] * d[26] -
                  2 * d[2] * d[4] * d[28] + d[1] * d[5] * d[28] + d[1] * d[4] * d[29] + 2 * d[2] * d[6] * d[30] -
                  d[0] * d[8] * d[30] - d[0] * d[6] * d[32];
    coeffs[170] = -d[8] * d[18] * d[24] - d[6] * d[20] * d[24] + d[5] * d[16] * d[25] + d[4] * d[17] * d[25] -
                  2 * d[4] * d[16] * d[26] + 2 * d[6] * d[18] * d[26] + d[5] * d[13] * d[28] -
                  2 * d[4] * d[14] * d[28] - 2 * d[2] * d[16] * d[28] + d[1] * d[17] * d[28] + d[4] * d[13] * d[29] +
                  d[1] * d[16] * d[29] - d[8] * d[12] * d[30] + 2 * d[6] * d[14] * d[30] + 2 * d[2] * d[18] * d[30] -
                  d[0] * d[20] * d[30] - d[6] * d[12] * d[32] - d[0] * d[18] * d[32];
    coeffs[171] = -d[18] * d[20] * d[24] + d[16] * d[17] * d[25] - d[16] * d[16] * d[26] + d[18] * d[18] * d[26] -
                  2 * d[14] * d[16] * d[28] + d[13] * d[17] * d[28] + d[13] * d[16] * d[29] +
                  2 * d[14] * d[18] * d[30] - d[12] * d[20] * d[30] - d[12] * d[18] * d[32];
    coeffs[172] = d[5] * d[25] * d[28] - 2 * d[4] * d[26] * d[28] - d[2] * d[28] * d[28] + d[4] * d[25] * d[29] +
                  d[1] * d[28] * d[29] - d[8] * d[24] * d[30] + 2 * d[6] * d[26] * d[30] + d[2] * d[30] * d[30] -
                  d[6] * d[24] * d[32] - d[0] * d[30] * d[32];
    coeffs[173] = d[17] * d[25] * d[28] - 2 * d[16] * d[26] * d[28] - d[14] * d[28] * d[28] + d[16] * d[25] * d[29] +
                  d[13] * d[28] * d[29] - d[20] * d[24] * d[30] + 2 * d[18] * d[26] * d[30] + d[14] * d[30] * d[30] -
                  d[18] * d[24] * d[32] - d[12] * d[30] * d[32];
    coeffs[174] = -d[26] * d[28] * d[28] + d[25] * d[28] * d[29] + d[26] * d[30] * d[30] - d[24] * d[30] * d[32];
    coeffs[175] = -d[6] * d[8] * d[36] + d[4] * d[5] * d[37] - d[4] * d[4] * d[38] + d[6] * d[6] * d[38] -
                  2 * d[2] * d[4] * d[40] + d[1] * d[5] * d[40] + d[1] * d[4] * d[41] + 2 * d[2] * d[6] * d[42] -
                  d[0] * d[8] * d[42] - d[0] * d[6] * d[44];
    coeffs[176] = -d[8] * d[18] * d[36] - d[6] * d[20] * d[36] + d[5] * d[16] * d[37] + d[4] * d[17] * d[37] -
                  2 * d[4] * d[16] * d[38] + 2 * d[6] * d[18] * d[38] + d[5] * d[13] * d[40] -
                  2 * d[4] * d[14] * d[40] - 2 * d[2] * d[16] * d[40] + d[1] * d[17] * d[40] + d[4] * d[13] * d[41] +
                  d[1] * d[16] * d[41] - d[8] * d[12] * d[42] + 2 * d[6] * d[14] * d[42] + 2 * d[2] * d[18] * d[42] -
                  d[0] * d[20] * d[42] - d[6] * d[12] * d[44] - d[0] * d[18] * d[44];
    coeffs[177] = -d[18] * d[20] * d[36] + d[16] * d[17] * d[37] - d[16] * d[16] * d[38] + d[18] * d[18] * d[38] -
                  2 * d[14] * d[16] * d[40] + d[13] * d[17] * d[40] + d[13] * d[16] * d[41] +
                  2 * d[14] * d[18] * d[42] - d[12] * d[20] * d[42] - d[12] * d[18] * d[44];
    coeffs[178] = -d[8] * d[30] * d[36] - d[6] * d[32] * d[36] + d[5] * d[28] * d[37] + d[4] * d[29] * d[37] -
                  2 * d[4] * d[28] * d[38] + 2 * d[6] * d[30] * d[38] + d[5] * d[25] * d[40] -
                  2 * d[4] * d[26] * d[40] - 2 * d[2] * d[28] * d[40] + d[1] * d[29] * d[40] + d[4] * d[25] * d[41] +
                  d[1] * d[28] * d[41] - d[8] * d[24] * d[42] + 2 * d[6] * d[26] * d[42] + 2 * d[2] * d[30] * d[42] -
                  d[0] * d[32] * d[42] - d[6] * d[24] * d[44] - d[0] * d[30] * d[44];
    coeffs[179] = -d[20] * d[30] * d[36] - d[18] * d[32] * d[36] + d[17] * d[28] * d[37] + d[16] * d[29] * d[37] -
                  2 * d[16] * d[28] * d[38] + 2 * d[18] * d[30] * d[38] + d[17] * d[25] * d[40] -
                  2 * d[16] * d[26] * d[40] - 2 * d[14] * d[28] * d[40] + d[13] * d[29] * d[40] +
                  d[16] * d[25] * d[41] + d[13] * d[28] * d[41] - d[20] * d[24] * d[42] + 2 * d[18] * d[26] * d[42] +
                  2 * d[14] * d[30] * d[42] - d[12] * d[32] * d[42] - d[18] * d[24] * d[44] - d[12] * d[30] * d[44];
    coeffs[180] = -d[30] * d[32] * d[36] + d[28] * d[29] * d[37] - d[28] * d[28] * d[38] + d[30] * d[30] * d[38] -
                  2 * d[26] * d[28] * d[40] + d[25] * d[29] * d[40] + d[25] * d[28] * d[41] +
                  2 * d[26] * d[30] * d[42] - d[24] * d[32] * d[42] - d[24] * d[30] * d[44];
    coeffs[181] = d[5] * d[37] * d[40] - 2 * d[4] * d[38] * d[40] - d[2] * d[40] * d[40] + d[4] * d[37] * d[41] +
                  d[1] * d[40] * d[41] - d[8] * d[36] * d[42] + 2 * d[6] * d[38] * d[42] + d[2] * d[42] * d[42] -
                  d[6] * d[36] * d[44] - d[0] * d[42] * d[44];
    coeffs[182] = d[17] * d[37] * d[40] - 2 * d[16] * d[38] * d[40] - d[14] * d[40] * d[40] + d[16] * d[37] * d[41] +
                  d[13] * d[40] * d[41] - d[20] * d[36] * d[42] + 2 * d[18] * d[38] * d[42] + d[14] * d[42] * d[42] -
                  d[18] * d[36] * d[44] - d[12] * d[42] * d[44];
    coeffs[183] = d[29] * d[37] * d[40] - 2 * d[28] * d[38] * d[40] - d[26] * d[40] * d[40] + d[28] * d[37] * d[41] +
                  d[25] * d[40] * d[41] - d[32] * d[36] * d[42] + 2 * d[30] * d[38] * d[42] + d[26] * d[42] * d[42] -
                  d[30] * d[36] * d[44] - d[24] * d[42] * d[44];
    coeffs[184] = -d[38] * d[40] * d[40] + d[37] * d[40] * d[41] + d[38] * d[42] * d[42] - d[36] * d[42] * d[44];
    coeffs[185] = -d[6] * d[8] * d[48] + d[4] * d[5] * d[49] - d[4] * d[4] * d[50] + d[6] * d[6] * d[50] -
                  2 * d[2] * d[4] * d[52] + d[1] * d[5] * d[52] + d[1] * d[4] * d[53] + 2 * d[2] * d[6] * d[54] -
                  d[0] * d[8] * d[54] - d[0] * d[6] * d[56];
    coeffs[186] = -d[8] * d[18] * d[48] - d[6] * d[20] * d[48] + d[5] * d[16] * d[49] + d[4] * d[17] * d[49] -
                  2 * d[4] * d[16] * d[50] + 2 * d[6] * d[18] * d[50] + d[5] * d[13] * d[52] -
                  2 * d[4] * d[14] * d[52] - 2 * d[2] * d[16] * d[52] + d[1] * d[17] * d[52] + d[4] * d[13] * d[53] +
                  d[1] * d[16] * d[53] - d[8] * d[12] * d[54] + 2 * d[6] * d[14] * d[54] + 2 * d[2] * d[18] * d[54] -
                  d[0] * d[20] * d[54] - d[6] * d[12] * d[56] - d[0] * d[18] * d[56];
    coeffs[187] = -d[18] * d[20] * d[48] + d[16] * d[17] * d[49] - d[16] * d[16] * d[50] + d[18] * d[18] * d[50] -
                  2 * d[14] * d[16] * d[52] + d[13] * d[17] * d[52] + d[13] * d[16] * d[53] +
                  2 * d[14] * d[18] * d[54] - d[12] * d[20] * d[54] - d[12] * d[18] * d[56];
    coeffs[188] = -d[8] * d[30] * d[48] - d[6] * d[32] * d[48] + d[5] * d[28] * d[49] + d[4] * d[29] * d[49] -
                  2 * d[4] * d[28] * d[50] + 2 * d[6] * d[30] * d[50] + d[5] * d[25] * d[52] -
                  2 * d[4] * d[26] * d[52] - 2 * d[2] * d[28] * d[52] + d[1] * d[29] * d[52] + d[4] * d[25] * d[53] +
                  d[1] * d[28] * d[53] - d[8] * d[24] * d[54] + 2 * d[6] * d[26] * d[54] + 2 * d[2] * d[30] * d[54] -
                  d[0] * d[32] * d[54] - d[6] * d[24] * d[56] - d[0] * d[30] * d[56];
    coeffs[189] = -d[20] * d[30] * d[48] - d[18] * d[32] * d[48] + d[17] * d[28] * d[49] + d[16] * d[29] * d[49] -
                  2 * d[16] * d[28] * d[50] + 2 * d[18] * d[30] * d[50] + d[17] * d[25] * d[52] -
                  2 * d[16] * d[26] * d[52] - 2 * d[14] * d[28] * d[52] + d[13] * d[29] * d[52] +
                  d[16] * d[25] * d[53] + d[13] * d[28] * d[53] - d[20] * d[24] * d[54] + 2 * d[18] * d[26] * d[54] +
                  2 * d[14] * d[30] * d[54] - d[12] * d[32] * d[54] - d[18] * d[24] * d[56] - d[12] * d[30] * d[56];
    coeffs[190] = -d[30] * d[32] * d[48] + d[28] * d[29] * d[49] - d[28] * d[28] * d[50] + d[30] * d[30] * d[50] -
                  2 * d[26] * d[28] * d[52] + d[25] * d[29] * d[52] + d[25] * d[28] * d[53] +
                  2 * d[26] * d[30] * d[54] - d[24] * d[32] * d[54] - d[24] * d[30] * d[56];
    coeffs[191] = -d[8] * d[42] * d[48] - d[6] * d[44] * d[48] + d[5] * d[40] * d[49] + d[4] * d[41] * d[49] -
                  2 * d[4] * d[40] * d[50] + 2 * d[6] * d[42] * d[50] + d[5] * d[37] * d[52] -
                  2 * d[4] * d[38] * d[52] - 2 * d[2] * d[40] * d[52] + d[1] * d[41] * d[52] + d[4] * d[37] * d[53] +
                  d[1] * d[40] * d[53] - d[8] * d[36] * d[54] + 2 * d[6] * d[38] * d[54] + 2 * d[2] * d[42] * d[54] -
                  d[0] * d[44] * d[54] - d[6] * d[36] * d[56] - d[0] * d[42] * d[56];
    coeffs[192] = -d[20] * d[42] * d[48] - d[18] * d[44] * d[48] + d[17] * d[40] * d[49] + d[16] * d[41] * d[49] -
                  2 * d[16] * d[40] * d[50] + 2 * d[18] * d[42] * d[50] + d[17] * d[37] * d[52] -
                  2 * d[16] * d[38] * d[52] - 2 * d[14] * d[40] * d[52] + d[13] * d[41] * d[52] +
                  d[16] * d[37] * d[53] + d[13] * d[40] * d[53] - d[20] * d[36] * d[54] + 2 * d[18] * d[38] * d[54] +
                  2 * d[14] * d[42] * d[54] - d[12] * d[44] * d[54] - d[18] * d[36] * d[56] - d[12] * d[42] * d[56];
    coeffs[193] = -d[32] * d[42] * d[48] - d[30] * d[44] * d[48] + d[29] * d[40] * d[49] + d[28] * d[41] * d[49] -
                  2 * d[28] * d[40] * d[50] + 2 * d[30] * d[42] * d[50] + d[29] * d[37] * d[52] -
                  2 * d[28] * d[38] * d[52] - 2 * d[26] * d[40] * d[52] + d[25] * d[41] * d[52] +
                  d[28] * d[37] * d[53] + d[25] * d[40] * d[53] - d[32] * d[36] * d[54] + 2 * d[30] * d[38] * d[54] +
                  2 * d[26] * d[42] * d[54] - d[24] * d[44] * d[54] - d[30] * d[36] * d[56] - d[24] * d[42] * d[56];
    coeffs[194] = -d[42] * d[44] * d[48] + d[40] * d[41] * d[49] - d[40] * d[40] * d[50] + d[42] * d[42] * d[50] -
                  2 * d[38] * d[40] * d[52] + d[37] * d[41] * d[52] + d[37] * d[40] * d[53] +
                  2 * d[38] * d[42] * d[54] - d[36] * d[44] * d[54] - d[36] * d[42] * d[56];
    coeffs[195] = d[5] * d[49] * d[52] - 2 * d[4] * d[50] * d[52] - d[2] * d[52] * d[52] + d[4] * d[49] * d[53] +
                  d[1] * d[52] * d[53] - d[8] * d[48] * d[54] + 2 * d[6] * d[50] * d[54] + d[2] * d[54] * d[54] -
                  d[6] * d[48] * d[56] - d[0] * d[54] * d[56];
    coeffs[196] = d[17] * d[49] * d[52] - 2 * d[16] * d[50] * d[52] - d[14] * d[52] * d[52] + d[16] * d[49] * d[53] +
                  d[13] * d[52] * d[53] - d[20] * d[48] * d[54] + 2 * d[18] * d[50] * d[54] + d[14] * d[54] * d[54] -
                  d[18] * d[48] * d[56] - d[12] * d[54] * d[56];
    coeffs[197] = d[29] * d[49] * d[52] - 2 * d[28] * d[50] * d[52] - d[26] * d[52] * d[52] + d[28] * d[49] * d[53] +
                  d[25] * d[52] * d[53] - d[32] * d[48] * d[54] + 2 * d[30] * d[50] * d[54] + d[26] * d[54] * d[54] -
                  d[30] * d[48] * d[56] - d[24] * d[54] * d[56];
    coeffs[198] = d[41] * d[49] * d[52] - 2 * d[40] * d[50] * d[52] - d[38] * d[52] * d[52] + d[40] * d[49] * d[53] +
                  d[37] * d[52] * d[53] - d[44] * d[48] * d[54] + 2 * d[42] * d[50] * d[54] + d[38] * d[54] * d[54] -
                  d[42] * d[48] * d[56] - d[36] * d[54] * d[56];
    coeffs[199] = -d[50] * d[52] * d[52] + d[49] * d[52] * d[53] + d[50] * d[54] * d[54] - d[48] * d[54] * d[56];
    coeffs[200] = d[2] * d[3] * d[6] + d[2] * d[4] * d[7] - d[0] * d[3] * d[8] - d[1] * d[4] * d[8];
    coeffs[201] = -d[3] * d[8] * d[12] - d[4] * d[8] * d[13] + d[3] * d[6] * d[14] + d[4] * d[7] * d[14] +
                  d[2] * d[6] * d[15] - d[0] * d[8] * d[15] + d[2] * d[7] * d[16] - d[1] * d[8] * d[16] +
                  d[2] * d[3] * d[18] + d[2] * d[4] * d[19] - d[0] * d[3] * d[20] - d[1] * d[4] * d[20];
    coeffs[202] = -d[8] * d[12] * d[15] + d[6] * d[14] * d[15] - d[8] * d[13] * d[16] + d[7] * d[14] * d[16] +
                  d[3] * d[14] * d[18] + d[2] * d[15] * d[18] + d[4] * d[14] * d[19] + d[2] * d[16] * d[19] -
                  d[3] * d[12] * d[20] - d[4] * d[13] * d[20] - d[0] * d[15] * d[20] - d[1] * d[16] * d[20];
    coeffs[203] = d[14] * d[15] * d[18] + d[14] * d[16] * d[19] - d[12] * d[15] * d[20] - d[13] * d[16] * d[20];
    coeffs[204] = -d[3] * d[8] * d[24] - d[4] * d[8] * d[25] + d[3] * d[6] * d[26] + d[4] * d[7] * d[26] +
                  d[2] * d[6] * d[27] - d[0] * d[8] * d[27] + d[2] * d[7] * d[28] - d[1] * d[8] * d[28] +
                  d[2] * d[3] * d[30] + d[2] * d[4] * d[31] - d[0] * d[3] * d[32] - d[1] * d[4] * d[32];
    coeffs[205] = -d[8] * d[15] * d[24] - d[3] * d[20] * d[24] - d[8] * d[16] * d[25] - d[4] * d[20] * d[25] +
                  d[6] * d[15] * d[26] + d[7] * d[16] * d[26] + d[3] * d[18] * d[26] + d[4] * d[19] * d[26] -
                  d[8] * d[12] * d[27] + d[6] * d[14] * d[27] + d[2] * d[18] * d[27] - d[0] * d[20] * d[27] -
                  d[8] * d[13] * d[28] + d[7] * d[14] * d[28] + d[2] * d[19] * d[28] - d[1] * d[20] * d[28] +
                  d[3] * d[14] * d[30] + d[2] * d[15] * d[30] + d[4] * d[14] * d[31] + d[2] * d[16] * d[31] -
                  d[3] * d[12] * d[32] - d[4] * d[13] * d[32] - d[0] * d[15] * d[32] - d[1] * d[16] * d[32];
    coeffs[206] = -d[15] * d[20] * d[24] - d[16] * d[20] * d[25] + d[15] * d[18] * d[26] + d[16] * d[19] * d[26] +
                  d[14] * d[18] * d[27] - d[12] * d[20] * d[27] + d[14] * d[19] * d[28] - d[13] * d[20] * d[28] +
                  d[14] * d[15] * d[30] + d[14] * d[16] * d[31] - d[12] * d[15] * d[32] - d[13] * d[16] * d[32];
    coeffs[207] = -d[8] * d[24] * d[27] + d[6] * d[26] * d[27] - d[8] * d[25] * d[28] + d[7] * d[26] * d[28] +
                  d[3] * d[26] * d[30] + d[2] * d[27] * d[30] + d[4] * d[26] * d[31] + d[2] * d[28] * d[31] -
                  d[3] * d[24] * d[32] - d[4] * d[25] * d[32] - d[0] * d[27] * d[32] - d[1] * d[28] * d[32];
    coeffs[208] = -d[20] * d[24] * d[27] + d[18] * d[26] * d[27] - d[20] * d[25] * d[28] + d[19] * d[26] * d[28] +
                  d[15] * d[26] * d[30] + d[14] * d[27] * d[30] + d[16] * d[26] * d[31] + d[14] * d[28] * d[31] -
                  d[15] * d[24] * d[32] - d[16] * d[25] * d[32] - d[12] * d[27] * d[32] - d[13] * d[28] * d[32];
    coeffs[209] = d[26] * d[27] * d[30] + d[26] * d[28] * d[31] - d[24] * d[27] * d[32] - d[25] * d[28] * d[32];
    coeffs[210] = -d[3] * d[8] * d[36] - d[4] * d[8] * d[37] + d[3] * d[6] * d[38] + d[4] * d[7] * d[38] +
                  d[2] * d[6] * d[39] - d[0] * d[8] * d[39] + d[2] * d[7] * d[40] - d[1] * d[8] * d[40] +
                  d[2] * d[3] * d[42] + d[2] * d[4] * d[43] - d[0] * d[3] * d[44] - d[1] * d[4] * d[44];
    coeffs[211] = -d[8] * d[15] * d[36] - d[3] * d[20] * d[36] - d[8] * d[16] * d[37] - d[4] * d[20] * d[37] +
                  d[6] * d[15] * d[38] + d[7] * d[16] * d[38] + d[3] * d[18] * d[38] + d[4] * d[19] * d[38] -
                  d[8] * d[12] * d[39] + d[6] * d[14] * d[39] + d[2] * d[18] * d[39] - d[0] * d[20] * d[39] -
                  d[8] * d[13] * d[40] + d[7] * d[14] * d[40] + d[2] * d[19] * d[40] - d[1] * d[20] * d[40] +
                  d[3] * d[14] * d[42] + d[2] * d[15] * d[42] + d[4] * d[14] * d[43] + d[2] * d[16] * d[43] -
                  d[3] * d[12] * d[44] - d[4] * d[13] * d[44] - d[0] * d[15] * d[44] - d[1] * d[16] * d[44];
    coeffs[212] = -d[15] * d[20] * d[36] - d[16] * d[20] * d[37] + d[15] * d[18] * d[38] + d[16] * d[19] * d[38] +
                  d[14] * d[18] * d[39] - d[12] * d[20] * d[39] + d[14] * d[19] * d[40] - d[13] * d[20] * d[40] +
                  d[14] * d[15] * d[42] + d[14] * d[16] * d[43] - d[12] * d[15] * d[44] - d[13] * d[16] * d[44];
    coeffs[213] = -d[8] * d[27] * d[36] - d[3] * d[32] * d[36] - d[8] * d[28] * d[37] - d[4] * d[32] * d[37] +
                  d[6] * d[27] * d[38] + d[7] * d[28] * d[38] + d[3] * d[30] * d[38] + d[4] * d[31] * d[38] -
                  d[8] * d[24] * d[39] + d[6] * d[26] * d[39] + d[2] * d[30] * d[39] - d[0] * d[32] * d[39] -
                  d[8] * d[25] * d[40] + d[7] * d[26] * d[40] + d[2] * d[31] * d[40] - d[1] * d[32] * d[40] +
                  d[3] * d[26] * d[42] + d[2] * d[27] * d[42] + d[4] * d[26] * d[43] + d[2] * d[28] * d[43] -
                  d[3] * d[24] * d[44] - d[4] * d[25] * d[44] - d[0] * d[27] * d[44] - d[1] * d[28] * d[44];
    coeffs[214] = -d[20] * d[27] * d[36] - d[15] * d[32] * d[36] - d[20] * d[28] * d[37] - d[16] * d[32] * d[37] +
                  d[18] * d[27] * d[38] + d[19] * d[28] * d[38] + d[15] * d[30] * d[38] + d[16] * d[31] * d[38] -
                  d[20] * d[24] * d[39] + d[18] * d[26] * d[39] + d[14] * d[30] * d[39] - d[12] * d[32] * d[39] -
                  d[20] * d[25] * d[40] + d[19] * d[26] * d[40] + d[14] * d[31] * d[40] - d[13] * d[32] * d[40] +
                  d[15] * d[26] * d[42] + d[14] * d[27] * d[42] + d[16] * d[26] * d[43] + d[14] * d[28] * d[43] -
                  d[15] * d[24] * d[44] - d[16] * d[25] * d[44] - d[12] * d[27] * d[44] - d[13] * d[28] * d[44];
    coeffs[215] = -d[27] * d[32] * d[36] - d[28] * d[32] * d[37] + d[27] * d[30] * d[38] + d[28] * d[31] * d[38] +
                  d[26] * d[30] * d[39] - d[24] * d[32] * d[39] + d[26] * d[31] * d[40] - d[25] * d[32] * d[40] +
                  d[26] * d[27] * d[42] + d[26] * d[28] * d[43] - d[24] * d[27] * d[44] - d[25] * d[28] * d[44];
    coeffs[216] = -d[8] * d[36] * d[39] + d[6] * d[38] * d[39] - d[8] * d[37] * d[40] + d[7] * d[38] * d[40] +
                  d[3] * d[38] * d[42] + d[2] * d[39] * d[42] + d[4] * d[38] * d[43] + d[2] * d[40] * d[43] -
                  d[3] * d[36] * d[44] - d[4] * d[37] * d[44] - d[0] * d[39] * d[44] - d[1] * d[40] * d[44];
    coeffs[217] = -d[20] * d[36] * d[39] + d[18] * d[38] * d[39] - d[20] * d[37] * d[40] + d[19] * d[38] * d[40] +
                  d[15] * d[38] * d[42] + d[14] * d[39] * d[42] + d[16] * d[38] * d[43] + d[14] * d[40] * d[43] -
                  d[15] * d[36] * d[44] - d[16] * d[37] * d[44] - d[12] * d[39] * d[44] - d[13] * d[40] * d[44];
    coeffs[218] = -d[32] * d[36] * d[39] + d[30] * d[38] * d[39] - d[32] * d[37] * d[40] + d[31] * d[38] * d[40] +
                  d[27] * d[38] * d[42] + d[26] * d[39] * d[42] + d[28] * d[38] * d[43] + d[26] * d[40] * d[43] -
                  d[27] * d[36] * d[44] - d[28] * d[37] * d[44] - d[24] * d[39] * d[44] - d[25] * d[40] * d[44];
    coeffs[219] = d[38] * d[39] * d[42] + d[38] * d[40] * d[43] - d[36] * d[39] * d[44] - d[37] * d[40] * d[44];
    coeffs[220] = -d[3] * d[8] * d[48] - d[4] * d[8] * d[49] + d[3] * d[6] * d[50] + d[4] * d[7] * d[50] +
                  d[2] * d[6] * d[51] - d[0] * d[8] * d[51] + d[2] * d[7] * d[52] - d[1] * d[8] * d[52] +
                  d[2] * d[3] * d[54] + d[2] * d[4] * d[55] - d[0] * d[3] * d[56] - d[1] * d[4] * d[56];
    coeffs[221] = -d[8] * d[15] * d[48] - d[3] * d[20] * d[48] - d[8] * d[16] * d[49] - d[4] * d[20] * d[49] +
                  d[6] * d[15] * d[50] + d[7] * d[16] * d[50] + d[3] * d[18] * d[50] + d[4] * d[19] * d[50] -
                  d[8] * d[12] * d[51] + d[6] * d[14] * d[51] + d[2] * d[18] * d[51] - d[0] * d[20] * d[51] -
                  d[8] * d[13] * d[52] + d[7] * d[14] * d[52] + d[2] * d[19] * d[52] - d[1] * d[20] * d[52] +
                  d[3] * d[14] * d[54] + d[2] * d[15] * d[54] + d[4] * d[14] * d[55] + d[2] * d[16] * d[55] -
                  d[3] * d[12] * d[56] - d[4] * d[13] * d[56] - d[0] * d[15] * d[56] - d[1] * d[16] * d[56];
    coeffs[222] = -d[15] * d[20] * d[48] - d[16] * d[20] * d[49] + d[15] * d[18] * d[50] + d[16] * d[19] * d[50] +
                  d[14] * d[18] * d[51] - d[12] * d[20] * d[51] + d[14] * d[19] * d[52] - d[13] * d[20] * d[52] +
                  d[14] * d[15] * d[54] + d[14] * d[16] * d[55] - d[12] * d[15] * d[56] - d[13] * d[16] * d[56];
    coeffs[223] = -d[8] * d[27] * d[48] - d[3] * d[32] * d[48] - d[8] * d[28] * d[49] - d[4] * d[32] * d[49] +
                  d[6] * d[27] * d[50] + d[7] * d[28] * d[50] + d[3] * d[30] * d[50] + d[4] * d[31] * d[50] -
                  d[8] * d[24] * d[51] + d[6] * d[26] * d[51] + d[2] * d[30] * d[51] - d[0] * d[32] * d[51] -
                  d[8] * d[25] * d[52] + d[7] * d[26] * d[52] + d[2] * d[31] * d[52] - d[1] * d[32] * d[52] +
                  d[3] * d[26] * d[54] + d[2] * d[27] * d[54] + d[4] * d[26] * d[55] + d[2] * d[28] * d[55] -
                  d[3] * d[24] * d[56] - d[4] * d[25] * d[56] - d[0] * d[27] * d[56] - d[1] * d[28] * d[56];
    coeffs[224] = -d[20] * d[27] * d[48] - d[15] * d[32] * d[48] - d[20] * d[28] * d[49] - d[16] * d[32] * d[49] +
                  d[18] * d[27] * d[50] + d[19] * d[28] * d[50] + d[15] * d[30] * d[50] + d[16] * d[31] * d[50] -
                  d[20] * d[24] * d[51] + d[18] * d[26] * d[51] + d[14] * d[30] * d[51] - d[12] * d[32] * d[51] -
                  d[20] * d[25] * d[52] + d[19] * d[26] * d[52] + d[14] * d[31] * d[52] - d[13] * d[32] * d[52] +
                  d[15] * d[26] * d[54] + d[14] * d[27] * d[54] + d[16] * d[26] * d[55] + d[14] * d[28] * d[55] -
                  d[15] * d[24] * d[56] - d[16] * d[25] * d[56] - d[12] * d[27] * d[56] - d[13] * d[28] * d[56];
    coeffs[225] = -d[27] * d[32] * d[48] - d[28] * d[32] * d[49] + d[27] * d[30] * d[50] + d[28] * d[31] * d[50] +
                  d[26] * d[30] * d[51] - d[24] * d[32] * d[51] + d[26] * d[31] * d[52] - d[25] * d[32] * d[52] +
                  d[26] * d[27] * d[54] + d[26] * d[28] * d[55] - d[24] * d[27] * d[56] - d[25] * d[28] * d[56];
    coeffs[226] = -d[8] * d[39] * d[48] - d[3] * d[44] * d[48] - d[8] * d[40] * d[49] - d[4] * d[44] * d[49] +
                  d[6] * d[39] * d[50] + d[7] * d[40] * d[50] + d[3] * d[42] * d[50] + d[4] * d[43] * d[50] -
                  d[8] * d[36] * d[51] + d[6] * d[38] * d[51] + d[2] * d[42] * d[51] - d[0] * d[44] * d[51] -
                  d[8] * d[37] * d[52] + d[7] * d[38] * d[52] + d[2] * d[43] * d[52] - d[1] * d[44] * d[52] +
                  d[3] * d[38] * d[54] + d[2] * d[39] * d[54] + d[4] * d[38] * d[55] + d[2] * d[40] * d[55] -
                  d[3] * d[36] * d[56] - d[4] * d[37] * d[56] - d[0] * d[39] * d[56] - d[1] * d[40] * d[56];
    coeffs[227] = -d[20] * d[39] * d[48] - d[15] * d[44] * d[48] - d[20] * d[40] * d[49] - d[16] * d[44] * d[49] +
                  d[18] * d[39] * d[50] + d[19] * d[40] * d[50] + d[15] * d[42] * d[50] + d[16] * d[43] * d[50] -
                  d[20] * d[36] * d[51] + d[18] * d[38] * d[51] + d[14] * d[42] * d[51] - d[12] * d[44] * d[51] -
                  d[20] * d[37] * d[52] + d[19] * d[38] * d[52] + d[14] * d[43] * d[52] - d[13] * d[44] * d[52] +
                  d[15] * d[38] * d[54] + d[14] * d[39] * d[54] + d[16] * d[38] * d[55] + d[14] * d[40] * d[55] -
                  d[15] * d[36] * d[56] - d[16] * d[37] * d[56] - d[12] * d[39] * d[56] - d[13] * d[40] * d[56];
    coeffs[228] = -d[32] * d[39] * d[48] - d[27] * d[44] * d[48] - d[32] * d[40] * d[49] - d[28] * d[44] * d[49] +
                  d[30] * d[39] * d[50] + d[31] * d[40] * d[50] + d[27] * d[42] * d[50] + d[28] * d[43] * d[50] -
                  d[32] * d[36] * d[51] + d[30] * d[38] * d[51] + d[26] * d[42] * d[51] - d[24] * d[44] * d[51] -
                  d[32] * d[37] * d[52] + d[31] * d[38] * d[52] + d[26] * d[43] * d[52] - d[25] * d[44] * d[52] +
                  d[27] * d[38] * d[54] + d[26] * d[39] * d[54] + d[28] * d[38] * d[55] + d[26] * d[40] * d[55] -
                  d[27] * d[36] * d[56] - d[28] * d[37] * d[56] - d[24] * d[39] * d[56] - d[25] * d[40] * d[56];
    coeffs[229] = -d[39] * d[44] * d[48] - d[40] * d[44] * d[49] + d[39] * d[42] * d[50] + d[40] * d[43] * d[50] +
                  d[38] * d[42] * d[51] - d[36] * d[44] * d[51] + d[38] * d[43] * d[52] - d[37] * d[44] * d[52] +
                  d[38] * d[39] * d[54] + d[38] * d[40] * d[55] - d[36] * d[39] * d[56] - d[37] * d[40] * d[56];
    coeffs[230] = -d[8] * d[48] * d[51] + d[6] * d[50] * d[51] - d[8] * d[49] * d[52] + d[7] * d[50] * d[52] +
                  d[3] * d[50] * d[54] + d[2] * d[51] * d[54] + d[4] * d[50] * d[55] + d[2] * d[52] * d[55] -
                  d[3] * d[48] * d[56] - d[4] * d[49] * d[56] - d[0] * d[51] * d[56] - d[1] * d[52] * d[56];
    coeffs[231] = -d[20] * d[48] * d[51] + d[18] * d[50] * d[51] - d[20] * d[49] * d[52] + d[19] * d[50] * d[52] +
                  d[15] * d[50] * d[54] + d[14] * d[51] * d[54] + d[16] * d[50] * d[55] + d[14] * d[52] * d[55] -
                  d[15] * d[48] * d[56] - d[16] * d[49] * d[56] - d[12] * d[51] * d[56] - d[13] * d[52] * d[56];
    coeffs[232] = -d[32] * d[48] * d[51] + d[30] * d[50] * d[51] - d[32] * d[49] * d[52] + d[31] * d[50] * d[52] +
                  d[27] * d[50] * d[54] + d[26] * d[51] * d[54] + d[28] * d[50] * d[55] + d[26] * d[52] * d[55] -
                  d[27] * d[48] * d[56] - d[28] * d[49] * d[56] - d[24] * d[51] * d[56] - d[25] * d[52] * d[56];
    coeffs[233] = -d[44] * d[48] * d[51] + d[42] * d[50] * d[51] - d[44] * d[49] * d[52] + d[43] * d[50] * d[52] +
                  d[39] * d[50] * d[54] + d[38] * d[51] * d[54] + d[40] * d[50] * d[55] + d[38] * d[52] * d[55] -
                  d[39] * d[48] * d[56] - d[40] * d[49] * d[56] - d[36] * d[51] * d[56] - d[37] * d[52] * d[56];
    coeffs[234] = d[50] * d[51] * d[54] + d[50] * d[52] * d[55] - d[48] * d[51] * d[56] - d[49] * d[52] * d[56];

    // Setup elimination template
    static const int coeffs0_ind[] = {
        0,   15,  30,  45,  60,  95,  130, 165, 200, 1,   0,   15,  16,  30,  31,  45,  46,  61,  96,  131, 166, 201,
        2,   1,   16,  17,  31,  32,  46,  47,  62,  97,  132, 167, 202, 2,   17,  32,  47,  63,  98,  133, 168, 203,
        3,   18,  15,  0,   30,  33,  45,  48,  64,  99,  134, 169, 204, 4,   3,   18,  19,  16,  1,   31,  33,  34,
        46,  48,  49,  65,  100, 135, 170, 205, 4,   19,  17,  2,   32,  34,  47,  49,  66,  101, 136, 171, 206, 5,
        20,  18,  3,   33,  35,  48,  50,  67,  102, 137, 172, 207, 5,   20,  19,  4,   34,  35,  49,  50,  68,  103,
        138, 173, 208, 20,  5,   35,  50,  69,  104, 139, 174, 209, 6,   21,  36,  30,  15,  45,  0,   51,  70,  105,
        140, 175, 210, 7,   6,   21,  22,  36,  37,  31,  16,  46,  1,   51,  52,  71,  106, 141, 176, 211, 7,   22,
        37,  32,  17,  47,  2,   52,  72,  107, 142, 177, 212, 8,   23,  21,  6,   36,  38,  51,  33,  18,  48,  3,
        53,  73,  108, 143, 178, 213, 8,   23,  22,  7,   37,  38,  52,  34,  19,  49,  4,   53,  74,  109, 144, 179,
        214, 10,  25,  40,  45,  30,  0,   15,  55,  80,  115, 150, 185, 220, 11,  10,  25,  26,  40,  41,  55,  46,
        31,  1,   16,  56,  81,  116, 151, 186, 221, 11,  26,  41,  56,  47,  32,  2,   17,  82,  117, 152, 187, 222,
        12,  27,  25,  10,  40,  42,  55,  48,  33,  3,   18,  57,  83,  118, 153, 188, 223, 12,  27,  26,  11,  41,
        42,  56,  57,  49,  34,  4,   19,  84,  119, 154, 189, 224, 9,   24,  39,  36,  21,  51,  6,   54,  76,  111,
        146, 181, 216, 9,   24,  39,  37,  22,  52,  7,   54,  77,  112, 147, 182, 217, 23,  8,   38,  53,  35,  20,
        50,  5,   75,  110, 145, 180, 215, 24,  9,   39,  54,  38,  23,  53,  8,   78,  113, 148, 183, 218, 39,  24,
        54,  9,   79,  114, 149, 184, 219};
    static const int coeffs1_ind[] = {
        59,  44,  14,  29,  94,  129, 164, 199, 234, 14,  29,  44,  55,  40,  10,  25,  59,  90,  125, 160,
        195, 230, 13,  28,  43,  40,  25,  55,  10,  51,  36,  6,   21,  58,  86,  121, 156, 191, 226, 14,
        29,  44,  59,  56,  41,  11,  26,  91,  126, 161, 196, 231, 13,  28,  43,  41,  26,  56,  11,  58,
        52,  37,  7,   22,  87,  122, 157, 192, 227, 29,  14,  44,  59,  57,  42,  12,  27,  92,  127, 162,
        197, 232, 27,  12,  42,  57,  50,  35,  5,   20,  85,  120, 155, 190, 225, 28,  13,  43,  58,  42,
        27,  57,  12,  53,  38,  8,   23,  88,  123, 158, 193, 228, 44,  29,  59,  14,  58,  43,  13,  28,
        93,  128, 163, 198, 233, 43,  28,  58,  13,  54,  39,  9,   24,  89,  124, 159, 194, 229};
    static const int C0_ind[] = {
        0,   3,   8,   19,  20,  21,  22,  23,  24,  25,  26,  27,  28,  32,  33,  39,  44,  45,  46,  47,  48,  49,
        50,  51,  52,  53,  57,  58,  64,  69,  70,  71,  72,  73,  74,  76,  77,  82,  89,  95,  96,  97,  98,  99,
        100, 103, 104, 105, 106, 108, 109, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133,
        134, 139, 144, 145, 146, 147, 148, 149, 151, 152, 154, 155, 156, 157, 159, 164, 170, 171, 172, 173, 174, 175,
        178, 179, 180, 181, 183, 184, 194, 195, 196, 197, 198, 199, 201, 202, 204, 205, 206, 207, 209, 214, 220, 221,
        222, 223, 224, 229, 230, 231, 234, 245, 246, 247, 248, 249, 250, 253, 258, 260, 261, 262, 263, 269, 270, 271,
        272, 273, 274, 275, 276, 277, 278, 282, 283, 285, 286, 287, 288, 289, 294, 295, 296, 297, 298, 299, 301, 302,
        307, 310, 311, 312, 313, 314, 320, 321, 322, 323, 324, 325, 328, 329, 330, 331, 333, 334, 335, 336, 337, 338,
        344, 345, 346, 347, 348, 349, 351, 352, 354, 355, 356, 357, 359, 360, 361, 362, 363, 364, 370, 371, 372, 373,
        374, 375, 378, 383, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 407, 408, 414, 415,
        416, 417, 418, 419, 420, 421, 422, 423, 424, 426, 427, 432, 439, 440, 441, 442, 443, 445, 446, 447, 448, 449,
        450, 453, 454, 455, 456, 458, 459, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 476, 477, 479, 480, 481,
        482, 484, 489, 490, 491, 492, 493, 495, 496, 497, 498, 499, 500, 503, 508, 510, 511, 512, 513, 519, 520, 521,
        522, 523, 524, 526, 527, 532, 535, 536, 537, 538, 539, 545, 546, 547, 548, 549, 554, 555, 556, 559, 560, 561,
        562, 563, 570, 571, 572, 573, 574, 579, 580, 581, 584, 585, 586, 587, 588, 595, 596, 597, 598, 599, 610, 611,
        612, 613, 620, 621, 622, 623, 624};
    static const int C1_ind[] = {
        15,  16,  17,  18,  20,  21,  22,  23,  24,  25,  28,  33,  40,  41,  42,  43,  44,  45,  46,  47,
        48,  49,  50,  53,  58,  60,  61,  62,  63,  65,  66,  67,  68,  69,  70,  71,  72,  73,  74,  76,
        77,  82,  89,  90,  91,  92,  93,  95,  96,  97,  98,  99,  101, 102, 107, 110, 111, 112, 113, 114,
        115, 116, 117, 118, 120, 121, 122, 123, 124, 129, 130, 131, 134, 140, 141, 142, 143, 145, 146, 147,
        148, 149, 154, 155, 156, 159, 165, 166, 167, 168, 170, 171, 172, 173, 174, 179, 180, 181, 184, 185,
        186, 187, 188, 190, 191, 192, 193, 195, 196, 197, 198, 199, 210, 211, 212, 213, 215, 216, 217, 218,
        220, 221, 222, 223, 224, 235, 236, 237, 238, 240, 241, 242, 243, 245, 246, 247, 248, 249};

    Eigen::Matrix<double, 25, 25> C0;
    C0.setZero();
    Eigen::Matrix<double, 25, 10> C1;
    C1.setZero();
    for (int i = 0; i < 337; i++) {
        C0(C0_ind[i]) = coeffs[coeffs0_ind[i]];
    }
    for (int i = 0; i < 138; i++) {
        C1(C1_ind[i]) = coeffs[coeffs1_ind[i]];
    }

    Eigen::Matrix<double, 25, 10> C12 = C0.partialPivLu().solve(C1);

    // Setup action matrix
    Eigen::Matrix<double, 10, 10> AM;
    AM.setZero();
    AM(0, 8) = 1.0;
    AM(1, 2) = 1.0;
    AM.row(2) = -C12.row(20);
    AM(3, 4) = 1.0;
    AM.row(4) = -C12.row(21);
    AM(5, 7) = 1.0;
    AM.row(6) = -C12.row(22);
    AM.row(7) = -C12.row(23);
    AM(8, 9) = 1.0;
    AM.row(9) = -C12.row(24);

    // Solve eigenvalue problem
    Eigen::EigenSolver<Eigen::Matrix<double, 10, 10>> es(AM, false);
    Eigen::Array<std::complex<double>, 10, 1> D = es.eigenvalues();

    int nroots = 0;
    double eigv[10];
    for (int i = 0; i < 10; i++) {
        if (std::abs(D(i).imag()) < 1e-6)
            eigv[nroots++] = D(i).real();
    }

    Eigen::Matrix<double, 4, 10> sols;
    fast_eigenvector_solver(eigv, nroots, AM, &sols);

    output_poses->reserve(nroots);
    output_focals->reserve(nroots);
    for (int i = 0; i < nroots; ++i) {
        Eigen::Matrix<double, 5, 1> v;
        v << sols.col(i), 1.0;
        Eigen::Matrix<double, 12, 1> Pv = N * v;
        Eigen::Matrix<double, 3, 4> P = Eigen::Map<Eigen::Matrix<double, 3, 4>>(Pv.data());

        if (P.block<3, 3>(0, 0).determinant() < 0)
            P = -P;

        P = P / P.block<1, 3>(2, 0).norm();
        double focal = (P.block<1, 3>(0, 0).norm() + P.block<1, 3>(1, 0).norm()) / 2;
        P.row(0) = P.row(0) / focal;
        P.row(1) = P.row(1) / focal;

        Eigen::Matrix3d R = P.block<3, 3>(0, 0);
        Eigen::Vector3d t = P.block<3, 1>(0, 3);

        CameraPose pose(R, t);
        output_poses->emplace_back(pose);
        output_focals->emplace_back(focal);
    }

    return output_poses->size();
}

} // namespace poselib